package uniswap_test

import (
	"context"
	"math/big"
	"testing"

	"github.com/ethereum/go-ethereum/common"
	"github.com/ethereum/go-ethereum/common/hexutil"
	"github.com/rss3-network/node/config"
	source "github.com/rss3-network/node/internal/engine/source/ethereum"
	worker "github.com/rss3-network/node/internal/engine/worker/contract/uniswap"
	"github.com/rss3-network/node/provider/ethereum"
	"github.com/rss3-network/node/provider/ethereum/contract/uniswap"
	"github.com/rss3-network/node/provider/ethereum/endpoint"
	"github.com/rss3-network/protocol-go/schema"
	"github.com/rss3-network/protocol-go/schema/filter"
	"github.com/rss3-network/protocol-go/schema/metadata"
	"github.com/samber/lo"
	"github.com/shopspring/decimal"
	"github.com/stretchr/testify/require"
)

func TestWorker_Ethereum(t *testing.T) {
	t.Parallel()

	type arguments struct {
		task   *source.Task
		config *config.Module
	}

	testcases := []struct {
		name      string
		arguments arguments
		want      *schema.Feed
		wantError require.ErrorAssertionFunc
	}{
		{
			name: "Swap RAI for DAI on Universal Router",
			arguments: arguments{
				task: &source.Task{
					Network: filter.NetworkEthereum,
					ChainID: 1,
					Header: &ethereum.Header{
						Hash:         common.HexToHash("0x04eea124abdeed2a6c9676e71631a2bf0c8850babacd302517e3ce2534421b2c"),
						ParentHash:   common.HexToHash("0x49495451b1f8987f2ea7970429eaaf882f0e7102a8b06e73e6a3c76c320ae8b2"),
						UncleHash:    common.HexToHash("0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347"),
						Coinbase:     common.HexToAddress("0xDAFEA492D9c6733ae3d56b7Ed1ADB60692c98Bc5"),
						Number:       lo.Must(new(big.Int).SetString("16803370", 0)),
						GasLimit:     30000000,
						GasUsed:      11563128,
						Timestamp:    1678519847,
						BaseFee:      lo.Must(new(big.Int).SetString("326898794882", 0)),
						Transactions: nil,
					},
					Transaction: &ethereum.Transaction{
						BlockHash: common.HexToHash("0x872ef1fca3aacd6ef892511edbc72d79917a59026dfb792d64f4f7c3f1bcdc5c"),
						From:      common.HexToAddress("0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045"),
						Gas:       322240,
						GasPrice:  lo.Must(new(big.Int).SetString("328898794882", 10)),
						Hash:      common.HexToHash("0x872ef1fca3aacd6ef892511edbc72d79917a59026dfb792d64f4f7c3f1bcdc5c"),
						Input:     hexutil.MustDecode("0x3593564c000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000640c350b00000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000021e19e0c9bab24000000000000000000000000000000000000000000000000005c149c4fb1e893cd58f00000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000002b03ab458634910aad20ef5f1c8ee96f1d6ac549190001f46b175474e89094c44da98b954eedeac495271d0f000000000000000000000000000000000000000000"),
						To:        lo.ToPtr(common.HexToAddress("0xEf1c6E67703c7BD7107eed8303Fbe6EC2554BF6B")),
						Value:     lo.Must(new(big.Int).SetString("0", 0)),
						Type:      2,
						ChainID:   lo.Must(new(big.Int).SetString("1", 0)),
					},
					Receipt: &ethereum.Receipt{
						BlockHash:         common.HexToHash("0x04eea124abdeed2a6c9676e71631a2bf0c8850babacd302517e3ce2534421b2c"),
						BlockNumber:       lo.Must(new(big.Int).SetString("16803370", 0)),
						ContractAddress:   nil,
						CumulativeGasUsed: 1172888,
						EffectiveGasPrice: hexutil.MustDecodeBig("0x4c93e55582"),
						GasUsed:           159508,
						Logs: []*ethereum.Log{
							{
								Address: common.HexToAddress("0x6B175474E89094C44Da98b954EedeAC495271d0F"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000cb0c5d9d92f4f2f80cce7aa271a1e148c226e19d"),
									common.HexToHash("0x000000000000000000000000d8da6bf26964af9d7eed9e03e53415d37aa96045"),
								},
								Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000005c15ac95ff1ff92e518"),
								BlockNumber:     lo.Must(new(big.Int).SetString("16803370", 0)),
								TransactionHash: common.HexToHash("0x872ef1fca3aacd6ef892511edbc72d79917a59026dfb792d64f4f7c3f1bcdc5c"),
								Index:           22,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0x03ab458634910AaD20eF5f1C8ee96F1D6ac54919"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000d8da6bf26964af9d7eed9e03e53415d37aa96045"),
									common.HexToHash("0x000000000000000000000000cb0c5d9d92f4f2f80cce7aa271a1e148c226e19d"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000021e19e0c9bab2400000"),
								BlockNumber:     lo.Must(new(big.Int).SetString("16803370", 0)),
								TransactionHash: common.HexToHash("0x872ef1fca3aacd6ef892511edbc72d79917a59026dfb792d64f4f7c3f1bcdc5c"),
								Index:           23,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xcB0C5d9D92f4F2F80cce7aa271a1E148c226e19D"),
								Topics: []common.Hash{
									common.HexToHash("0xc42079f94a6350d7e6235f29174924f928cc2ac818eb64fed8004e115fbcca67"),
									common.HexToHash("0x000000000000000000000000ef1c6e67703c7bd7107eed8303fbe6ec2554bf6b"),
									common.HexToHash("0x000000000000000000000000d8da6bf26964af9d7eed9e03e53415d37aa96045"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000021e19e0c9bab2400000fffffffffffffffffffffffffffffffffffffffffffffa3ea536a00e006d1ae80000000000000000000000000000000000000001a1504276fbc51f11f625673a00000000000000000000000000000000000000000000918355d1b5d0bb617733000000000000000000000000000000000000000000000000000000000000262d"),
								BlockNumber:     lo.Must(new(big.Int).SetString("16803370", 0)),
								TransactionHash: common.HexToHash("0x872ef1fca3aacd6ef892511edbc72d79917a59026dfb792d64f4f7c3f1bcdc5c"),
								Index:           24,
								Removed:         false,
							},
						},
						Status:           1,
						TransactionHash:  common.HexToHash("0x872ef1fca3aacd6ef892511edbc72d79917a59026dfb792d64f4f7c3f1bcdc5c"),
						TransactionIndex: 4,
					},
				},
				config: &config.Module{
					Network:  filter.NetworkEthereum,
					Endpoint: endpoint.MustGet(filter.NetworkEthereum),
				},
			},
			want: &schema.Feed{
				ID:      "0x872ef1fca3aacd6ef892511edbc72d79917a59026dfb792d64f4f7c3f1bcdc5c",
				Network: filter.NetworkEthereum,
				Index:   4,
				From:    "0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045",
				To:      uniswap.AddressUniversalRouter.String(),
				Type:    filter.TypeExchangeSwap,
				Calldata: &schema.Calldata{
					FunctionHash: "0x3593564c",
				},
				Platform: lo.ToPtr(filter.PlatformUniswap),
				Fee: &schema.Fee{
					Amount:  lo.Must(decimal.NewFromString("52461988974038056")),
					Decimal: 18,
				},
				Actions: []*schema.Action{
					{
						Type:     filter.TypeExchangeSwap,
						Platform: filter.PlatformUniswap.String(),
						From:     "0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045",
						To:       "0xd8dA6BF26964aF9D7eEd9e03E53415D37aA96045",
						Metadata: metadata.ExchangeSwap{
							From: metadata.Token{
								Address:  lo.ToPtr("0x03ab458634910AaD20eF5f1C8ee96F1D6ac54919"),
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("10000000000000000000000"))),
								Name:     "Rai Reflex Index",
								Symbol:   "RAI",
								Decimals: 18,
								Standard: metadata.StandardERC20,
							},
							To: metadata.Token{
								Address:  lo.ToPtr("0x6B175474E89094C44Da98b954EedeAC495271d0F"),
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("27178595886000881460504"))),
								Name:     "Dai Stablecoin",
								Symbol:   "DAI",
								Decimals: 18,
								Standard: metadata.StandardERC20,
							},
						},
					},
				},
				Status:    true,
				Timestamp: 1678519847,
			},
			wantError: require.NoError,
		},
		{
			name: "Swap LUSD for WETH on Universal Router",
			arguments: arguments{
				task: &source.Task{
					Network: filter.NetworkEthereum,
					ChainID: 1,
					Header: &ethereum.Header{
						Hash:         common.HexToHash("0x3502faead807c1d9755406ca713d88f2fc35a2e44a6aa1ebad07f3ea356eda6f"),
						ParentHash:   common.HexToHash("0x9e74e3e18471f236c127d889642053baf75c31c52d2a6454527455f8847dfc24"),
						UncleHash:    common.HexToHash("0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347"),
						Coinbase:     common.HexToAddress("0x70D5cCC14a1a264c05Ff48B3ec6751b0959541aA"),
						Number:       lo.Must(new(big.Int).SetString("17525252", 0)),
						GasLimit:     30000000,
						GasUsed:      20998344,
						Timestamp:    1687316771,
						BaseFee:      lo.Must(new(big.Int).SetString("13446942426", 0)),
						Transactions: nil,
					},
					Transaction: &ethereum.Transaction{
						BlockHash: common.HexToHash("0xf5f4c7b09fe2bc00b16506c285e9e4a03116775ad0c35164104f1b49beb9fa81"),
						From:      common.HexToAddress("0xB5A7c3f565f0DFDb4EE63d0ca4b4d59fa69c391C"),
						Gas:       359295,
						GasPrice:  lo.Must(new(big.Int).SetString("15446942426", 10)),
						Hash:      common.HexToHash("0xf5f4c7b09fe2bc00b16506c285e9e4a03116775ad0c35164104f1b49beb9fa81"),
						Input:     hexutil.MustDecode("0x24856bc30000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000030a000c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000006000000000000000000000000000000000000000000000000000000000000001e0000000000000000000000000000000000000000000000000000000000000032000000000000000000000000000000000000000000000000000000000000001600000000000000000000000005f98805a4e8be255a32880fdec7f6728c6568ba0000000000000000000000000ffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000064b9f60e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ef1c6e67703c7bd7107eed8303fbe6ec2554bf6b000000000000000000000000000000000000000000000000000000006492701600000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000004105d0b5dd0fbe7aed89ab3770eac56f01ff2ec77db74dcedbc0579fa239179eff0cd0b777287055b1c2bce6ebc7f8f1924ec5abc274a9691934dea00ffc557bd21c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000012000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000253029956a8df80000000000000000000000000000000000000000000000000000053df9628c95e7c100000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000425f98805a4e8be255a32880fdec7f6728c6568ba00001f4a0b86991c6218b36c1d19d4a2e9eb0ce3606eb480001f4c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000040000000000000000000000000b5a7c3f565f0dfdb4ee63d0ca4b4d59fa69c391c000000000000000000000000000000000000000000000000053df9628c95e7c1"),
						To:        lo.ToPtr(common.HexToAddress("0xEf1c6E67703c7BD7107eed8303Fbe6EC2554BF6B")),
						Value:     lo.Must(new(big.Int).SetString("0", 0)),
						Type:      2,
						ChainID:   lo.Must(new(big.Int).SetString("1", 0)),
					},
					Receipt: &ethereum.Receipt{
						BlockHash:         common.HexToHash("0x3502faead807c1d9755406ca713d88f2fc35a2e44a6aa1ebad07f3ea356eda6f"),
						BlockNumber:       lo.Must(new(big.Int).SetString("17525252", 0)),
						ContractAddress:   nil,
						CumulativeGasUsed: 5059070,
						EffectiveGasPrice: hexutil.MustDecodeBig("0x398b5a2da"),
						GasUsed:           248473,
						Logs: []*ethereum.Log{
							{
								Address: common.HexToAddress("0x000000000022D473030F116dDEE9F6B43aC78BA3"),
								Topics: []common.Hash{
									common.HexToHash("0xc6a377bfc4eb120024a8ac08eef205be16b817020812c73223e81d1bdb9708ec"),
									common.HexToHash("0x000000000000000000000000b5a7c3f565f0dfdb4ee63d0ca4b4d59fa69c391c"),
									common.HexToHash("0x0000000000000000000000005f98805a4e8be255a32880fdec7f6728c6568ba0"),
									common.HexToHash("0x000000000000000000000000ef1c6e67703c7bd7107eed8303fbe6ec2554bf6b"),
								},
								Data:            hexutil.MustDecode("0x000000000000000000000000ffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000064b9f60e0000000000000000000000000000000000000000000000000000000000000000"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17525252", 0)),
								TransactionHash: common.HexToHash("0xf5f4c7b09fe2bc00b16506c285e9e4a03116775ad0c35164104f1b49beb9fa81"),
								Index:           86,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x0000000000000000000000004e0924d3a751be199c426d52fb1f2337fa96f736"),
									common.HexToHash("0x000000000000000000000000ef1c6e67703c7bd7107eed8303fbe6ec2554bf6b"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000000000000290fe48b"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17525252", 0)),
								TransactionHash: common.HexToHash("0xf5f4c7b09fe2bc00b16506c285e9e4a03116775ad0c35164104f1b49beb9fa81"),
								Index:           87,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0x5f98805A4E8be255a32880FDeC7F6728C6568bA0"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000b5a7c3f565f0dfdb4ee63d0ca4b4d59fa69c391c"),
									common.HexToHash("0x0000000000000000000000004e0924d3a751be199c426d52fb1f2337fa96f736"),
								},
								Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000253029956a8df80000"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17525252", 0)),
								TransactionHash: common.HexToHash("0xf5f4c7b09fe2bc00b16506c285e9e4a03116775ad0c35164104f1b49beb9fa81"),
								Index:           88,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0x5f98805A4E8be255a32880FDeC7F6728C6568bA0"),
								Topics: []common.Hash{
									common.HexToHash("0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925"),
									common.HexToHash("0x000000000000000000000000b5a7c3f565f0dfdb4ee63d0ca4b4d59fa69c391c"),
									common.HexToHash("0x000000000000000000000000000000000022d473030f116ddee9f6b43ac78ba3"),
								},
								Data:            hexutil.MustDecode("0xffffffffffffffffffffffffffffffffffffffffffffffdacfd66a957207ffff"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17525252", 0)),
								TransactionHash: common.HexToHash("0xf5f4c7b09fe2bc00b16506c285e9e4a03116775ad0c35164104f1b49beb9fa81"),
								Index:           89,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0x4e0924d3a751bE199C426d52fb1f2337fa96f736"),
								Topics: []common.Hash{
									common.HexToHash("0xc42079f94a6350d7e6235f29174924f928cc2ac818eb64fed8004e115fbcca67"),
									common.HexToHash("0x000000000000000000000000ef1c6e67703c7bd7107eed8303fbe6ec2554bf6b"),
									common.HexToHash("0x000000000000000000000000ef1c6e67703c7bd7107eed8303fbe6ec2554bf6b"),
								},
								Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000253029956a8df80000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffd6f01b750000000000000000000000000000000000000000000010d121ee4a5ea212dbef00000000000000000000000000000000000000000000001aa7e98affd592f9f2fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffbc8cb"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17525252", 0)),
								TransactionHash: common.HexToHash("0xf5f4c7b09fe2bc00b16506c285e9e4a03116775ad0c35164104f1b49beb9fa81"),
								Index:           90,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x00000000000000000000000088e6a0c2ddd26feeb64f039a2c41296fcb3f5640"),
									common.HexToHash("0x000000000000000000000000ef1c6e67703c7bd7107eed8303fbe6ec2554bf6b"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000005482cf17451b14f"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17525252", 0)),
								TransactionHash: common.HexToHash("0xf5f4c7b09fe2bc00b16506c285e9e4a03116775ad0c35164104f1b49beb9fa81"),
								Index:           91,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000ef1c6e67703c7bd7107eed8303fbe6ec2554bf6b"),
									common.HexToHash("0x00000000000000000000000088e6a0c2ddd26feeb64f039a2c41296fcb3f5640"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000000000000290fe48b"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17525252", 0)),
								TransactionHash: common.HexToHash("0xf5f4c7b09fe2bc00b16506c285e9e4a03116775ad0c35164104f1b49beb9fa81"),
								Index:           92,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640"),
								Topics: []common.Hash{
									common.HexToHash("0xc42079f94a6350d7e6235f29174924f928cc2ac818eb64fed8004e115fbcca67"),
									common.HexToHash("0x000000000000000000000000ef1c6e67703c7bd7107eed8303fbe6ec2554bf6b"),
									common.HexToHash("0x000000000000000000000000ef1c6e67703c7bd7107eed8303fbe6ec2554bf6b"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000000000000290fe48bfffffffffffffffffffffffffffffffffffffffffffffffffab7d30e8bae4eb10000000000000000000000000000000000005bd6a439d2b10ace3baaed2469ad000000000000000000000000000000000000000000000001704dcd5233cf79c40000000000000000000000000000000000000000000000000000000000031262"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17525252", 0)),
								TransactionHash: common.HexToHash("0xf5f4c7b09fe2bc00b16506c285e9e4a03116775ad0c35164104f1b49beb9fa81"),
								Index:           93,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
								Topics: []common.Hash{
									common.HexToHash("0x7fcf532c15f0a6db0bd6d0e038bea71d30d808c7d98cb3bf7268a95bf5081b65"),
									common.HexToHash("0x000000000000000000000000ef1c6e67703c7bd7107eed8303fbe6ec2554bf6b"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000005482cf17451b14f"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17525252", 0)),
								TransactionHash: common.HexToHash("0xf5f4c7b09fe2bc00b16506c285e9e4a03116775ad0c35164104f1b49beb9fa81"),
								Index:           94,
								Removed:         false,
							},
						},
						Status:           1,
						TransactionHash:  common.HexToHash("0xf5f4c7b09fe2bc00b16506c285e9e4a03116775ad0c35164104f1b49beb9fa81"),
						TransactionIndex: 113,
					},
				},
				config: &config.Module{
					Network:  filter.NetworkEthereum,
					Endpoint: endpoint.MustGet(filter.NetworkEthereum),
				},
			},
			want: &schema.Feed{
				ID:      "0xf5f4c7b09fe2bc00b16506c285e9e4a03116775ad0c35164104f1b49beb9fa81",
				Network: filter.NetworkEthereum,
				Index:   113,
				From:    "0xB5A7c3f565f0DFDb4EE63d0ca4b4d59fa69c391C",
				To:      uniswap.AddressUniversalRouter.String(),
				Type:    filter.TypeExchangeSwap,
				Calldata: &schema.Calldata{
					FunctionHash: "0x24856bc3",
				},
				Platform: lo.ToPtr(filter.PlatformUniswap),
				Fee: &schema.Fee{
					Amount:  lo.Must(decimal.NewFromString("3838148125415498")),
					Decimal: 18,
				},
				Actions: []*schema.Action{
					{
						Type:     filter.TypeExchangeSwap,
						Platform: filter.PlatformUniswap.String(),
						From:     "0xB5A7c3f565f0DFDb4EE63d0ca4b4d59fa69c391C",
						To:       uniswap.AddressUniversalRouter.String(),
						Metadata: metadata.ExchangeSwap{
							From: metadata.Token{
								Address:  lo.ToPtr("0x5f98805A4E8be255a32880FDeC7F6728C6568bA0"),
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("686000000000000000000"))),
								Name:     "LUSD Stablecoin",
								Symbol:   "LUSD",
								Decimals: 18,
								Standard: metadata.StandardERC20,
							},
							To: metadata.Token{
								Address:  lo.ToPtr("0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"),
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("688907403"))),
								Name:     "USD Coin",
								Symbol:   "USDC",
								Decimals: 6,
								Standard: metadata.StandardERC20,
							},
						},
					},
					{
						Type:     filter.TypeExchangeSwap,
						Platform: filter.PlatformUniswap.String(),
						From:     uniswap.AddressUniversalRouter.String(),
						To:       uniswap.AddressUniversalRouter.String(),
						Metadata: metadata.ExchangeSwap{
							From: metadata.Token{
								Address:  lo.ToPtr("0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"),
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("688907403"))),
								Name:     "USD Coin",
								Symbol:   "USDC",
								Decimals: 6,
								Standard: metadata.StandardERC20,
							},
							To: metadata.Token{
								Address:  lo.ToPtr("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("380603584063058255"))),
								Name:     "Wrapped Ether",
								Symbol:   "WETH",
								Decimals: 18,
								Standard: metadata.StandardERC20,
							},
						},
					},
					{
						Type:     filter.TypeExchangeSwap,
						Platform: filter.PlatformUniswap.String(),
						From:     uniswap.AddressUniversalRouter.String(),
						To:       "0xB5A7c3f565f0DFDb4EE63d0ca4b4d59fa69c391C",
						Metadata: metadata.ExchangeSwap{
							From: metadata.Token{
								Address:  lo.ToPtr("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("380603584063058255"))),
								Name:     "Wrapped Ether",
								Symbol:   "WETH",
								Decimals: 18,
								Standard: metadata.StandardERC20,
							},
							To: metadata.Token{
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("380603584063058255"))),
								Name:     "Ethereum",
								Symbol:   "ETH",
								Decimals: 18,
							},
						},
					},
				},
				Status:    true,
				Timestamp: 1687316771,
			},
			wantError: require.NoError,
		},
		{
			name: "Swap DAI for ETH on Uniswap V2 Router 2",
			arguments: arguments{
				task: &source.Task{
					Network: filter.NetworkEthereum,
					ChainID: 1,
					Header: &ethereum.Header{
						Hash:         common.HexToHash("0x9960d6291f283a9dc0f23afd7aaab19b9121a654597585ba013bf769ac0af199"),
						ParentHash:   common.HexToHash("0x94f9eaba46340749840b9ec5fab7277a1007ab3c7ed207defc3be55886a55f55"),
						UncleHash:    common.HexToHash("0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347"),
						Coinbase:     common.HexToAddress("0x388C818CA8B9251b393131C08a736A67ccB19297"),
						Number:       lo.Must(new(big.Int).SetString("17208992", 0)),
						GasLimit:     30000000,
						GasUsed:      22361006,
						Timestamp:    1683466475,
						BaseFee:      lo.Must(new(big.Int).SetString("99283541571", 0)),
						Transactions: nil,
					},
					Transaction: &ethereum.Transaction{
						BlockHash: common.HexToHash("0x50479c222eca9d12f041ee1df2db6f9b8b77bf52be4d45536ab2bf0e7578260f"),
						From:      common.HexToAddress("0xe18e3F6015840c3675Add0b82dF801Ebb7D621f3"),
						Gas:       215703,
						GasPrice:  lo.Must(new(big.Int).SetString("99333626634", 10)),
						Hash:      common.HexToHash("0x50479c222eca9d12f041ee1df2db6f9b8b77bf52be4d45536ab2bf0e7578260f"),
						Input:     hexutil.MustDecode("0x18cbafe50000000000000000000000000000000000000000000000333ada195aebfd903000000000000000000000000000000000000000000000000006c868d9242a74c600000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000d8f47b07648f43cbcac55bb0bddbc46605290077000000000000000000000000000000000000000000000000000000006457afc600000000000000000000000000000000000000000000000000000000000000020000000000000000000000006b175474e89094c44da98b954eedeac495271d0f000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2"),
						To:        lo.ToPtr(common.HexToAddress("0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D")),
						Value:     lo.Must(new(big.Int).SetString("0", 0)),
						Type:      2,
						ChainID:   lo.Must(new(big.Int).SetString("1", 0)),
					},
					Receipt: &ethereum.Receipt{
						BlockHash:         common.HexToHash("0x9960d6291f283a9dc0f23afd7aaab19b9121a654597585ba013bf769ac0af199"),
						BlockNumber:       lo.Must(new(big.Int).SetString("17208992", 0)),
						ContractAddress:   nil,
						CumulativeGasUsed: 3541254,
						EffectiveGasPrice: hexutil.MustDecodeBig("0x1720bedb0a"),
						GasUsed:           113536,
						Logs: []*ethereum.Log{
							{
								Address: common.HexToAddress("0x6B175474E89094C44Da98b954EedeAC495271d0F"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000e18e3f6015840c3675add0b82df801ebb7d621f3"),
									common.HexToHash("0x000000000000000000000000a478c2975ab1ea89e8196811f51a7b7ade33eb11"),
								},
								Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000333ada195aebfd9030"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17208992", 0)),
								TransactionHash: common.HexToHash("0x50479c222eca9d12f041ee1df2db6f9b8b77bf52be4d45536ab2bf0e7578260f"),
								Index:           125,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000a478c2975ab1ea89e8196811f51a7b7ade33eb11"),
									common.HexToHash("0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000006d24d22ef47c1c6"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17208992", 0)),
								TransactionHash: common.HexToHash("0x50479c222eca9d12f041ee1df2db6f9b8b77bf52be4d45536ab2bf0e7578260f"),
								Index:           126,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xA478c2975Ab1Ea89e8196811F51A7B7Ade33eB11"),
								Topics: []common.Hash{
									common.HexToHash("0x1c411e9a96e071241c2f21f7726b17ae89e3cab4c78be50e062b03a9fffbbad1"),
								},
								Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000677d224dc5ac09bad46500000000000000000000000000000000000000000000000dd1dde594b50af78cc"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17208992", 0)),
								TransactionHash: common.HexToHash("0x50479c222eca9d12f041ee1df2db6f9b8b77bf52be4d45536ab2bf0e7578260f"),
								Index:           127,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xA478c2975Ab1Ea89e8196811F51A7B7Ade33eB11"),
								Topics: []common.Hash{
									common.HexToHash("0xd78ad95fa46c994b6551d0da85fc275fe613ce37657fb8d5e3d130840159d822"),
									common.HexToHash("0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d"),
									common.HexToHash("0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d"),
								},
								Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000333ada195aebfd90300000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006d24d22ef47c1c6"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17208992", 0)),
								TransactionHash: common.HexToHash("0x50479c222eca9d12f041ee1df2db6f9b8b77bf52be4d45536ab2bf0e7578260f"),
								Index:           128,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
								Topics: []common.Hash{
									common.HexToHash("0x7fcf532c15f0a6db0bd6d0e038bea71d30d808c7d98cb3bf7268a95bf5081b65"),
									common.HexToHash("0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000006d24d22ef47c1c6"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17208992", 0)),
								TransactionHash: common.HexToHash("0x50479c222eca9d12f041ee1df2db6f9b8b77bf52be4d45536ab2bf0e7578260f"),
								Index:           129,
								Removed:         false,
							},
						},
						Status:           1,
						TransactionHash:  common.HexToHash("0x50479c222eca9d12f041ee1df2db6f9b8b77bf52be4d45536ab2bf0e7578260f"),
						TransactionIndex: 26,
					},
				},
				config: &config.Module{
					Network:  filter.NetworkEthereum,
					Endpoint: endpoint.MustGet(filter.NetworkEthereum),
				},
			},
			want: &schema.Feed{
				ID:      "0x50479c222eca9d12f041ee1df2db6f9b8b77bf52be4d45536ab2bf0e7578260f",
				Network: filter.NetworkEthereum,
				Index:   26,
				From:    "0xe18e3F6015840c3675Add0b82dF801Ebb7D621f3",
				To:      uniswap.AddressV2SwapRouter02.String(),
				Type:    filter.TypeExchangeSwap,
				Calldata: &schema.Calldata{
					FunctionHash: "0x18cbafe5",
				},
				Platform: lo.ToPtr(filter.PlatformUniswap),
				Fee: &schema.Fee{
					Amount:  lo.Must(decimal.NewFromString("11277942633517824")),
					Decimal: 18,
				},
				Actions: []*schema.Action{
					{
						Type:     filter.TypeExchangeSwap,
						Platform: filter.PlatformUniswap.String(),
						From:     "0xe18e3F6015840c3675Add0b82dF801Ebb7D621f3",
						To:       uniswap.AddressV2SwapRouter02.String(),
						Metadata: metadata.ExchangeSwap{
							From: metadata.Token{
								Address:  lo.ToPtr("0x6B175474E89094C44Da98b954EedeAC495271d0F"),
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("945024677636606890032"))),
								Name:     "Dai Stablecoin",
								Symbol:   "DAI",
								Decimals: 18,
								Standard: metadata.StandardERC20,
							},
							To: metadata.Token{
								Address:  lo.ToPtr("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("491540121775489478"))),
								Name:     "Wrapped Ether",
								Symbol:   "WETH",
								Decimals: 18,
								Standard: metadata.StandardERC20,
							},
						},
					},
					{
						Type:     filter.TypeExchangeSwap,
						Platform: filter.PlatformUniswap.String(),
						From:     uniswap.AddressV2SwapRouter02.String(),
						To:       "0xe18e3F6015840c3675Add0b82dF801Ebb7D621f3",
						Metadata: metadata.ExchangeSwap{
							From: metadata.Token{
								Address:  lo.ToPtr("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("491540121775489478"))),
								Name:     "Wrapped Ether",
								Symbol:   "WETH",
								Decimals: 18,
								Standard: metadata.StandardERC20,
							},
							To: metadata.Token{
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("491540121775489478"))),
								Name:     "Ethereum",
								Symbol:   "ETH",
								Decimals: 18,
							},
						},
					},
				},
				Status:    true,
				Timestamp: 1683466475,
			},
			wantError: require.NoError,
		},
		{
			name: "Remove DAI and ETH liquidity from Uniswap V2 Pair",
			arguments: arguments{
				task: &source.Task{
					Network: filter.NetworkEthereum,
					ChainID: 1,
					Header: &ethereum.Header{
						Hash:         common.HexToHash("0x1e52d78de7884ff78f3c0792902e32afb1146130df233d91afdd5ddf0abc7511"),
						ParentHash:   common.HexToHash("0x1a729094faa4b9b92e5b2532cda1c4e8ad3e727114b95f77cfdae001edcc2943"),
						UncleHash:    common.HexToHash("0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347"),
						Coinbase:     common.HexToAddress("0x690B9A9E9aa1C9dB991C7721a92d351Db4FaC990"),
						Number:       lo.Must(new(big.Int).SetString("17261466", 0)),
						GasLimit:     30000000,
						GasUsed:      19158313,
						Timestamp:    1684108343,
						BaseFee:      lo.Must(new(big.Int).SetString("31042010247", 0)),
						Transactions: nil,
					},
					Transaction: &ethereum.Transaction{
						BlockHash: common.HexToHash("0xc59d2ed54f0ab05f4f40679aa1d32a6537ed75e4da8b496f8bee2c209186b335"),
						From:      common.HexToAddress("0x3E07f1C21024c1bdD2217e51E46C13C143B8aC12"),
						Gas:       311485,
						GasPrice:  lo.Must(new(big.Int).SetString("31130370247", 10)),
						Hash:      common.HexToHash("0xc59d2ed54f0ab05f4f40679aa1d32a6537ed75e4da8b496f8bee2c209186b335"),
						Input:     hexutil.MustDecode("0xded9382a0000000000000000000000006b175474e89094c44da98b954eedeac495271d0f0000000000000000000000000000000000000000000000008b5ef0df9ca4c1fa000000000000000000000000000000000000000000000027f606b2c9083d5bf400000000000000000000000000000000000000000000000005b15a898373f8a60000000000000000000000003e07f1c21024c1bdd2217e51e46c13c143b8ac120000000000000000000000000000000000000000000000000000000064617f170000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001cd9faf344c7ad575b71337cc6bcff4a5b8bdd8f98c473320e97c1e87133639c5b2da2ea5fa3041761fb53c3ed9edb0fe8b42057d818109c0af95f0c8008f7f9bb"),
						To:        lo.ToPtr(common.HexToAddress("0x7a250d5630B4cF539739dF2C5dAcb4c659F2488D")),
						Value:     lo.Must(new(big.Int).SetString("0", 0)),
						Type:      2,
						ChainID:   lo.Must(new(big.Int).SetString("1", 0)),
					},
					Receipt: &ethereum.Receipt{
						BlockHash:         common.HexToHash("0x1e52d78de7884ff78f3c0792902e32afb1146130df233d91afdd5ddf0abc7511"),
						BlockNumber:       lo.Must(new(big.Int).SetString("17261466", 0)),
						ContractAddress:   nil,
						CumulativeGasUsed: 18445202,
						EffectiveGasPrice: hexutil.MustDecodeBig("0x73f83c0c7"),
						GasUsed:           206007,
						Logs: []*ethereum.Log{
							{
								Address: common.HexToAddress("0xA478c2975Ab1Ea89e8196811F51A7B7Ade33eB11"),
								Topics: []common.Hash{
									common.HexToHash("0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925"),
									common.HexToHash("0x0000000000000000000000003e07f1c21024c1bdd2217e51e46c13c143b8ac12"),
									common.HexToHash("0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d"),
								},
								Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000008b5ef0df9ca4c1fa"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17261466", 0)),
								TransactionHash: common.HexToHash("0xc59d2ed54f0ab05f4f40679aa1d32a6537ed75e4da8b496f8bee2c209186b335"),
								Index:           462,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xA478c2975Ab1Ea89e8196811F51A7B7Ade33eB11"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x0000000000000000000000003e07f1c21024c1bdd2217e51e46c13c143b8ac12"),
									common.HexToHash("0x000000000000000000000000a478c2975ab1ea89e8196811f51a7b7ade33eb11"),
								},
								Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000008b5ef0df9ca4c1fa"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17261466", 0)),
								TransactionHash: common.HexToHash("0xc59d2ed54f0ab05f4f40679aa1d32a6537ed75e4da8b496f8bee2c209186b335"),
								Index:           463,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xA478c2975Ab1Ea89e8196811F51A7B7Ade33eB11"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000a478c2975ab1ea89e8196811f51a7b7ade33eb11"),
									common.HexToHash("0x0000000000000000000000000000000000000000000000000000000000000000"),
								},
								Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000008b5ef0df9ca4c1fa"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17261466", 0)),
								TransactionHash: common.HexToHash("0xc59d2ed54f0ab05f4f40679aa1d32a6537ed75e4da8b496f8bee2c209186b335"),
								Index:           464,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0x6B175474E89094C44Da98b954EedeAC495271d0F"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000a478c2975ab1ea89e8196811f51a7b7ade33eb11"),
									common.HexToHash("0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000002a1072d72474767bbe"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17261466", 0)),
								TransactionHash: common.HexToHash("0xc59d2ed54f0ab05f4f40679aa1d32a6537ed75e4da8b496f8bee2c209186b335"),
								Index:           465,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000a478c2975ab1ea89e8196811f51a7b7ade33eb11"),
									common.HexToHash("0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000005fe0e75cdbd7187"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17261466", 0)),
								TransactionHash: common.HexToHash("0xc59d2ed54f0ab05f4f40679aa1d32a6537ed75e4da8b496f8bee2c209186b335"),
								Index:           466,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xA478c2975Ab1Ea89e8196811F51A7B7Ade33eB11"),
								Topics: []common.Hash{
									common.HexToHash("0x1c411e9a96e071241c2f21f7726b17ae89e3cab4c78be50e062b03a9fffbbad1"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000006441cd6e0033710889fa50000000000000000000000000000000000000000000000e484f7714ef3e6e1c4"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17261466", 0)),
								TransactionHash: common.HexToHash("0xc59d2ed54f0ab05f4f40679aa1d32a6537ed75e4da8b496f8bee2c209186b335"),
								Index:           467,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xA478c2975Ab1Ea89e8196811F51A7B7Ade33eB11"),
								Topics: []common.Hash{
									common.HexToHash("0xdccd412f0b1252819cb1fd330b93224ca42612892bb3f4f789976e6d81936496"),
									common.HexToHash("0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d"),
									common.HexToHash("0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000002a1072d72474767bbe00000000000000000000000000000000000000000000000005fe0e75cdbd7187"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17261466", 0)),
								TransactionHash: common.HexToHash("0xc59d2ed54f0ab05f4f40679aa1d32a6537ed75e4da8b496f8bee2c209186b335"),
								Index:           468,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0x6B175474E89094C44Da98b954EedeAC495271d0F"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d"),
									common.HexToHash("0x0000000000000000000000003e07f1c21024c1bdd2217e51e46c13c143b8ac12"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000002a1072d72474767bbe"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17261466", 0)),
								TransactionHash: common.HexToHash("0xc59d2ed54f0ab05f4f40679aa1d32a6537ed75e4da8b496f8bee2c209186b335"),
								Index:           469,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
								Topics: []common.Hash{
									common.HexToHash("0x7fcf532c15f0a6db0bd6d0e038bea71d30d808c7d98cb3bf7268a95bf5081b65"),
									common.HexToHash("0x0000000000000000000000007a250d5630b4cf539739df2c5dacb4c659f2488d"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000005fe0e75cdbd7187"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17261466", 0)),
								TransactionHash: common.HexToHash("0xc59d2ed54f0ab05f4f40679aa1d32a6537ed75e4da8b496f8bee2c209186b335"),
								Index:           470,
								Removed:         false,
							},
						},
						Status:           1,
						TransactionHash:  common.HexToHash("0xc59d2ed54f0ab05f4f40679aa1d32a6537ed75e4da8b496f8bee2c209186b335"),
						TransactionIndex: 156,
					},
				},
				config: &config.Module{
					Network:  filter.NetworkEthereum,
					Endpoint: endpoint.MustGet(filter.NetworkEthereum),
				},
			},
			want: &schema.Feed{
				ID:      "0xc59d2ed54f0ab05f4f40679aa1d32a6537ed75e4da8b496f8bee2c209186b335",
				Network: filter.NetworkEthereum,
				Index:   156,
				From:    "0x3E07f1C21024c1bdD2217e51E46C13C143B8aC12",
				To:      uniswap.AddressV2SwapRouter02.String(),
				Type:    filter.TypeExchangeLiquidity,
				Calldata: &schema.Calldata{
					FunctionHash: "0xded9382a",
				},
				Platform: lo.ToPtr(filter.PlatformUniswap),
				Fee: &schema.Fee{
					Amount:  lo.Must(decimal.NewFromString("6413074183473729")),
					Decimal: 18,
				},
				Actions: []*schema.Action{
					{
						Type:     filter.TypeExchangeLiquidity,
						Platform: filter.PlatformUniswap.String(),
						From:     "0xA478c2975Ab1Ea89e8196811F51A7B7Ade33eB11",
						To:       "0x3E07f1C21024c1bdD2217e51E46C13C143B8aC12",
						Metadata: metadata.ExchangeLiquidity{
							Action: metadata.ActionExchangeLiquidityRemove,
							Tokens: []metadata.Token{
								{
									Address:  lo.ToPtr("0x6B175474E89094C44Da98b954EedeAC495271d0F"),
									Value:    lo.ToPtr(lo.Must(decimal.NewFromString("775948497299325746110"))),
									Name:     "Dai Stablecoin",
									Symbol:   "DAI",
									Decimals: 18,
									Standard: metadata.StandardERC20,
								},
								{
									Address:  lo.ToPtr("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
									Value:    lo.ToPtr(lo.Must(decimal.NewFromString("431798513399853447"))),
									Name:     "Wrapped Ether",
									Symbol:   "WETH",
									Decimals: 18,
									Standard: metadata.StandardERC20,
								},
							},
						},
					},
				},
				Status:    true,
				Timestamp: 1684108343,
			},
			wantError: require.NoError,
		},
		{
			name: "Add USDC and WETH liquidity to Uniswap Nonfungible Position Manager",
			arguments: arguments{
				task: &source.Task{
					Network: filter.NetworkEthereum,
					ChainID: 1,
					Header: &ethereum.Header{
						Hash:         common.HexToHash("0xf78ad62b69d4c8794857fca664f39718664a147e2634915c996c51ad83e53c84"),
						ParentHash:   common.HexToHash("0x905e4a0abb3c96e9f159694bde07cef09ca675d87f86ba4eb7452cb3c5b59c52"),
						UncleHash:    common.HexToHash("0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347"),
						Coinbase:     common.HexToAddress("0x1f9090aaE28b8a3dCeaDf281B0F12828e676c326"),
						Number:       lo.Must(new(big.Int).SetString("17368660", 0)),
						GasLimit:     30000000,
						GasUsed:      12057662,
						Timestamp:    1685412191,
						BaseFee:      lo.Must(new(big.Int).SetString("25894859302", 0)),
						Transactions: nil,
					},
					Transaction: &ethereum.Transaction{
						BlockHash: common.HexToHash("0x955784fc31f3ab7e09f6c0bd0b174d386fc3ca97ecda1ce3e150335164eafa8f"),
						From:      common.HexToAddress("0x36E5A96c8d01803d2C48756AA7bde1c01d7D9f8A"),
						Gas:       565450,
						GasPrice:  lo.Must(new(big.Int).SetString("25944859302", 10)),
						Hash:      common.HexToHash("0x955784fc31f3ab7e09f6c0bd0b174d386fc3ca97ecda1ce3e150335164eafa8f"),
						Input:     hexutil.MustDecode("0xac9650d800000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000001e0000000000000000000000000000000000000000000000000000000000000016488316456000000000000000000000000a0b86991c6218b36c1d19d4a2e9eb0ce3606eb48000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000001f40000000000000000000000000000000000000000000000000000000000030f7a00000000000000000000000000000000000000000000000000000000000311960000000000000000000000000000000000000000000000000000007cdfbf217a00000000000000000000000000000000000000000000000ebeb4723bb803c228000000000000000000000000000000000000000000000000000000661ce42f4300000000000000000000000000000000000000000000000bf0540d132c0eedd100000000000000000000000036e5a96c8d01803d2c48756aa7bde1c01d7d9f8a000000000000000000000000000000000000000000000000000000006475604f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000412210e8a00000000000000000000000000000000000000000000000000000000"),
						To:        lo.ToPtr(common.HexToAddress("0xC36442b4a4522E871399CD717aBDD847Ab11FE88")),
						Value:     lo.Must(new(big.Int).SetString("271996150995763839528", 0)),
						Type:      2,
						ChainID:   lo.Must(new(big.Int).SetString("1", 0)),
					},
					Receipt: &ethereum.Receipt{
						BlockHash:         common.HexToHash("0xf78ad62b69d4c8794857fca664f39718664a147e2634915c996c51ad83e53c84"),
						BlockNumber:       lo.Must(new(big.Int).SetString("17368660", 0)),
						ContractAddress:   nil,
						CumulativeGasUsed: 12036662,
						EffectiveGasPrice: hexutil.MustDecodeBig("0x60a6f22a6"),
						GasUsed:           453801,
						Logs: []*ethereum.Log{{
							Address: common.HexToAddress("0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x00000000000000000000000036e5a96c8d01803d2c48756aa7bde1c01d7d9f8a"),
								common.HexToHash("0x00000000000000000000000088e6a0c2ddd26feeb64f039a2c41296fcb3f5640"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000000007cdf22271e"),
							BlockNumber:     lo.Must(new(big.Int).SetString("17368660", 0)),
							TransactionHash: common.HexToHash("0x955784fc31f3ab7e09f6c0bd0b174d386fc3ca97ecda1ce3e150335164eafa8f"),
							Index:           299,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
							Topics: []common.Hash{
								common.HexToHash("0xe1fffcc4923d04b559f4d29a8bfc6cda04eb5b0d3c460751c2402c5c5cc9109c"),
								common.HexToHash("0x000000000000000000000000c36442b4a4522e871399cd717abdd847ab11fe88"),
							},
							Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000ebeb4723bb803c14c"),
							BlockNumber:     lo.Must(new(big.Int).SetString("17368660", 0)),
							TransactionHash: common.HexToHash("0x955784fc31f3ab7e09f6c0bd0b174d386fc3ca97ecda1ce3e150335164eafa8f"),
							Index:           300,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x000000000000000000000000c36442b4a4522e871399cd717abdd847ab11fe88"),
								common.HexToHash("0x00000000000000000000000088e6a0c2ddd26feeb64f039a2c41296fcb3f5640"),
							},
							Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000ebeb4723bb803c14c"),
							BlockNumber:     lo.Must(new(big.Int).SetString("17368660", 0)),
							TransactionHash: common.HexToHash("0x955784fc31f3ab7e09f6c0bd0b174d386fc3ca97ecda1ce3e150335164eafa8f"),
							Index:           301,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x88e6A0c2dDD26FEEb64F039a2c41296FcB3f5640"),
							Topics: []common.Hash{
								common.HexToHash("0x7a53080ba414158be7ec69b987b5fb7d07dee101fe85488f0853ae16239d0bde"),
								common.HexToHash("0x000000000000000000000000c36442b4a4522e871399cd717abdd847ab11fe88"),
								common.HexToHash("0x0000000000000000000000000000000000000000000000000000000000030f7a"),
								common.HexToHash("0x0000000000000000000000000000000000000000000000000000000000031196"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000c36442b4a4522e871399cd717abdd847ab11fe880000000000000000000000000000000000000000000000000c80bbae98ca36d30000000000000000000000000000000000000000000000000000007cdf22271e00000000000000000000000000000000000000000000000ebeb4723bb803c14c"),
							BlockNumber:     lo.Must(new(big.Int).SetString("17368660", 0)),
							TransactionHash: common.HexToHash("0x955784fc31f3ab7e09f6c0bd0b174d386fc3ca97ecda1ce3e150335164eafa8f"),
							Index:           302,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xC36442b4a4522E871399CD717aBDD847Ab11FE88"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x0000000000000000000000000000000000000000000000000000000000000000"),
								common.HexToHash("0x00000000000000000000000036e5a96c8d01803d2c48756aa7bde1c01d7d9f8a"),
								common.HexToHash("0x000000000000000000000000000000000000000000000000000000000007de31"),
							},
							Data:            nil,
							BlockNumber:     lo.Must(new(big.Int).SetString("17368660", 0)),
							TransactionHash: common.HexToHash("0x955784fc31f3ab7e09f6c0bd0b174d386fc3ca97ecda1ce3e150335164eafa8f"),
							Index:           303,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0xC36442b4a4522E871399CD717aBDD847Ab11FE88"),
							Topics: []common.Hash{
								common.HexToHash("0x3067048beee31b25b2f1681f88dac838c8bba36af25bfb2b7cf7473a5847e35f"),
								common.HexToHash("0x000000000000000000000000000000000000000000000000000000000007de31"),
							},
							Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000c80bbae98ca36d30000000000000000000000000000000000000000000000000000007cdf22271e00000000000000000000000000000000000000000000000ebeb4723bb803c14c"),
							BlockNumber:     lo.Must(new(big.Int).SetString("17368660", 0)),
							TransactionHash: common.HexToHash("0x955784fc31f3ab7e09f6c0bd0b174d386fc3ca97ecda1ce3e150335164eafa8f"),
							Index:           304,
							Removed:         false,
						}},
						Status:           1,
						TransactionHash:  common.HexToHash("0x955784fc31f3ab7e09f6c0bd0b174d386fc3ca97ecda1ce3e150335164eafa8f"),
						TransactionIndex: 117,
					},
				},
				config: &config.Module{
					Network:  filter.NetworkEthereum,
					Endpoint: endpoint.MustGet(filter.NetworkEthereum),
				},
			},
			want: &schema.Feed{
				ID:      "0x955784fc31f3ab7e09f6c0bd0b174d386fc3ca97ecda1ce3e150335164eafa8f",
				Network: filter.NetworkEthereum,
				Index:   117,
				From:    "0x36E5A96c8d01803d2C48756AA7bde1c01d7D9f8A",
				To:      uniswap.AddressNonfungiblePositionManager.String(),
				Type:    filter.TypeExchangeLiquidity,
				Calldata: &schema.Calldata{
					FunctionHash: "0xac9650d8",
				},
				Platform: lo.ToPtr(filter.PlatformUniswap),
				Fee: &schema.Fee{
					Amount:  lo.Must(decimal.NewFromString("11773803096106902")),
					Decimal: 18,
				},
				Actions: []*schema.Action{
					{
						Type:     filter.TypeTransactionMint,
						Platform: filter.PlatformUniswap.String(),
						From:     "0x0000000000000000000000000000000000000000",
						To:       "0x36E5A96c8d01803d2C48756AA7bde1c01d7D9f8A",
						Metadata: metadata.TransactionTransfer{
							Address:  lo.ToPtr("0xC36442b4a4522E871399CD717aBDD847Ab11FE88"),
							ID:       lo.ToPtr(decimal.NewFromInt(515633)),
							Value:    lo.ToPtr(decimal.NewFromInt(1)),
							Name:     "Uniswap V3 Positions NFT-V1",
							Symbol:   "UNI-V3-POS",
							Standard: metadata.StandardERC721,
							URI:      "data:application/json;base64,eyJuYW1lIjoiVW5pc3dhcCAtIDAuMDUlIC0gVVNEQy9XRVRIIC0gMTg0Ni41PD4xOTQ4LjkiLCAiZGVzY3JpcHRpb24iOiJUaGlzIE5GVCByZXByZXNlbnRzIGEgbGlxdWlkaXR5IHBvc2l0aW9uIGluIGEgVW5pc3dhcCBWMyBVU0RDLVdFVEggcG9vbC4gVGhlIG93bmVyIG9mIHRoaXMgTkZUIGNhbiBtb2RpZnkgb3IgcmVkZWVtIHRoZSBwb3NpdGlvbi5cblxuUG9vbCBBZGRyZXNzOiAweDg4ZTZhMGMyZGRkMjZmZWViNjRmMDM5YTJjNDEyOTZmY2IzZjU2NDBcblVTREMgQWRkcmVzczogMHhhMGI4Njk5MWM2MjE4YjM2YzFkMTlkNGEyZTllYjBjZTM2MDZlYjQ4XG5XRVRIIEFkZHJlc3M6IDB4YzAyYWFhMzliMjIzZmU4ZDBhMGU1YzRmMjdlYWQ5MDgzYzc1NmNjMlxuRmVlIFRpZXI6IDAuMDUlXG5Ub2tlbiBJRDogNTE1NjMzXG5cbuKaoO+4jyBESVNDTEFJTUVSOiBEdWUgZGlsaWdlbmNlIGlzIGltcGVyYXRpdmUgd2hlbiBhc3Nlc3NpbmcgdGhpcyBORlQuIE1ha2Ugc3VyZSB0b2tlbiBhZGRyZXNzZXMgbWF0Y2ggdGhlIGV4cGVjdGVkIHRva2VucywgYXMgdG9rZW4gc3ltYm9scyBtYXkgYmUgaW1pdGF0ZWQuIiwgImltYWdlIjogImRhdGE6aW1hZ2Uvc3ZnK3htbDtiYXNlNjQsUEhOMlp5QjNhV1IwYUQwaU1qa3dJaUJvWldsbmFIUTlJalV3TUNJZ2RtbGxkMEp2ZUQwaU1DQXdJREk1TUNBMU1EQWlJSGh0Ykc1elBTSm9kSFJ3T2k4dmQzZDNMbmN6TG05eVp5OHlNREF3TDNOMlp5SWdlRzFzYm5NNmVHeHBibXM5SjJoMGRIQTZMeTkzZDNjdWR6TXViM0puTHpFNU9Ua3ZlR3hwYm1zblBqeGtaV1p6UGp4bWFXeDBaWElnYVdROUltWXhJajQ4Wm1WSmJXRm5aU0J5WlhOMWJIUTlJbkF3SWlCNGJHbHVhenBvY21WbVBTSmtZWFJoT21sdFlXZGxMM04yWnl0NGJXdzdZbUZ6WlRZMExGQklUakphZVVJellWZFNNR0ZFTUc1TmFtdDNTbmxDYjFwWGJHNWhTRkU1U25wVmQwMURZMmRrYld4c1pEQktkbVZFTUc1TlEwRjNTVVJKTlUxRFFURk5SRUZ1U1Vob2RHSkhOWHBRVTJSdlpFaFNkMDlwT0haa00yUXpURzVqZWt4dE9YbGFlVGg1VFVSQmQwd3pUakphZVdNclVFaEtiRmt6VVdka01teHJaRWRuT1VwNlNUVk5TRUkwU25sQ2IxcFhiRzVoU0ZFNVNucFZkMDFJUWpSS2VVSnRZVmQ0YzFCVFkycFpWRUpwVDBSWk5VcDVPQ3RRUXpsNlpHMWpLeUl2UGp4bVpVbHRZV2RsSUhKbGMzVnNkRDBpY0RFaUlIaHNhVzVyT21oeVpXWTlJbVJoZEdFNmFXMWhaMlV2YzNabkszaHRiRHRpWVhObE5qUXNVRWhPTWxwNVFqTmhWMUl3WVVRd2JrMXFhM2RLZVVKdldsZHNibUZJVVRsS2VsVjNUVU5qWjJSdGJHeGtNRXAyWlVRd2JrMURRWGRKUkVrMVRVTkJNVTFFUVc1SlNHaDBZa2MxZWxCVFpHOWtTRkozVDJrNGRtUXpaRE5NYm1ONlRHMDVlVnA1T0hsTlJFRjNURE5PTWxwNVl5dFFSMDV3WTIxT2MxcFRRbXBsUkRCdVRWUlZNVXA1UW1wbFZEQnVUWHBGZVVwNVFubFFVMk40VFdwQ2QyVkRZMmRhYld4ellrUXdia2t5VFhkTmJVWm9XVk5qZGxCcWQzWmpNMXB1VUdjOVBTSXZQanhtWlVsdFlXZGxJSEpsYzNWc2REMGljRElpSUhoc2FXNXJPbWh5WldZOUltUmhkR0U2YVcxaFoyVXZjM1puSzNodGJEdGlZWE5sTmpRc1VFaE9NbHA1UWpOaFYxSXdZVVF3YmsxcWEzZEtlVUp2V2xkc2JtRklVVGxLZWxWM1RVTmpaMlJ0Ykd4a01FcDJaVVF3YmsxRFFYZEpSRWsxVFVOQk1VMUVRVzVKU0doMFlrYzFlbEJUWkc5a1NGSjNUMms0ZG1RelpETk1ibU42VEcwNWVWcDVPSGxOUkVGM1RETk9NbHA1WXl0UVIwNXdZMjFPYzFwVFFtcGxSREJ1VFZSWk1VcDVRbXBsVkRCdVRYcGpNMHA1UW5sUVUyTjRUV3BDZDJWRFkyZGFiV3h6WWtRd2JrbDZRVEphVjBrd1QwTmpkbEJxZDNaak0xcHVVR2M5UFNJZ0x6NDhabVZKYldGblpTQnlaWE4xYkhROUluQXpJaUI0YkdsdWF6cG9jbVZtUFNKa1lYUmhPbWx0WVdkbEwzTjJaeXQ0Yld3N1ltRnpaVFkwTEZCSVRqSmFlVUl6WVZkU01HRkVNRzVOYW10M1NubENiMXBYYkc1aFNGRTVTbnBWZDAxRFkyZGtiV3hzWkRCS2RtVkVNRzVOUTBGM1NVUkpOVTFEUVRGTlJFRnVTVWhvZEdKSE5YcFFVMlJ2WkVoU2QwOXBPSFprTTJRelRHNWpla3h0T1hsYWVUaDVUVVJCZDB3elRqSmFlV01yVUVkT2NHTnRUbk5hVTBKcVpVUXdiazlFUVc1SlIwNDFVRk5qZUU1RVFXNUpTRWs1U25wRmQwMUlRalJLZVVKdFlWZDRjMUJUWTJwT2VsVXlXVEpOZVVwNU9DdFFRemw2Wkcxakt5SWdMejQ4Wm1WQ2JHVnVaQ0J0YjJSbFBTSnZkbVZ5YkdGNUlpQnBiajBpY0RBaUlHbHVNajBpY0RFaUlDOCtQR1psUW14bGJtUWdiVzlrWlQwaVpYaGpiSFZ6YVc5dUlpQnBiakk5SW5BeUlpQXZQanhtWlVKc1pXNWtJRzF2WkdVOUltOTJaWEpzWVhraUlHbHVNajBpY0RNaUlISmxjM1ZzZEQwaVlteGxibVJQZFhRaUlDOCtQR1psUjJGMWMzTnBZVzVDYkhWeUlHbHVQU0ppYkdWdVpFOTFkQ0lnYzNSa1JHVjJhV0YwYVc5dVBTSTBNaUlnTHo0OEwyWnBiSFJsY2o0Z1BHTnNhWEJRWVhSb0lHbGtQU0pqYjNKdVpYSnpJajQ4Y21WamRDQjNhV1IwYUQwaU1qa3dJaUJvWldsbmFIUTlJalV3TUNJZ2NuZzlJalF5SWlCeWVUMGlORElpSUM4K1BDOWpiR2x3VUdGMGFENDhjR0YwYUNCcFpEMGlkR1Y0ZEMxd1lYUm9MV0VpSUdROUlrMDBNQ0F4TWlCSU1qVXdJRUV5T0NBeU9DQXdJREFnTVNBeU56Z2dOREFnVmpRMk1DQkJNamdnTWpnZ01DQXdJREVnTWpVd0lEUTRPQ0JJTkRBZ1FUSTRJREk0SURBZ01DQXhJREV5SURRMk1DQldOREFnUVRJNElESTRJREFnTUNBeElEUXdJREV5SUhvaUlDOCtQSEJoZEdnZ2FXUTlJbTFwYm1sdFlYQWlJR1E5SWsweU16UWdORFEwUXpJek5DQTBOVGN1T1RRNUlESTBNaTR5TVNBME5qTWdNalV6SURRMk15SWdMejQ4Wm1sc2RHVnlJR2xrUFNKMGIzQXRjbVZuYVc5dUxXSnNkWElpUGp4bVpVZGhkWE56YVdGdVFteDFjaUJwYmowaVUyOTFjbU5sUjNKaGNHaHBZeUlnYzNSa1JHVjJhV0YwYVc5dVBTSXlOQ0lnTHo0OEwyWnBiSFJsY2o0OGJHbHVaV0Z5UjNKaFpHbGxiblFnYVdROUltZHlZV1F0ZFhBaUlIZ3hQU0l4SWlCNE1qMGlNQ0lnZVRFOUlqRWlJSGt5UFNJd0lqNDhjM1J2Y0NCdlptWnpaWFE5SWpBdU1DSWdjM1J2Y0MxamIyeHZjajBpZDJocGRHVWlJSE4wYjNBdGIzQmhZMmwwZVQwaU1TSWdMejQ4YzNSdmNDQnZabVp6WlhROUlpNDVJaUJ6ZEc5d0xXTnZiRzl5UFNKM2FHbDBaU0lnYzNSdmNDMXZjR0ZqYVhSNVBTSXdJaUF2UGp3dmJHbHVaV0Z5UjNKaFpHbGxiblErUEd4cGJtVmhja2R5WVdScFpXNTBJR2xrUFNKbmNtRmtMV1J2ZDI0aUlIZ3hQU0l3SWlCNE1qMGlNU0lnZVRFOUlqQWlJSGt5UFNJeElqNDhjM1J2Y0NCdlptWnpaWFE5SWpBdU1DSWdjM1J2Y0MxamIyeHZjajBpZDJocGRHVWlJSE4wYjNBdGIzQmhZMmwwZVQwaU1TSWdMejQ4YzNSdmNDQnZabVp6WlhROUlqQXVPU0lnYzNSdmNDMWpiMnh2Y2owaWQyaHBkR1VpSUhOMGIzQXRiM0JoWTJsMGVUMGlNQ0lnTHo0OEwyeHBibVZoY2tkeVlXUnBaVzUwUGp4dFlYTnJJR2xrUFNKbVlXUmxMWFZ3SWlCdFlYTnJRMjl1ZEdWdWRGVnVhWFJ6UFNKdlltcGxZM1JDYjNWdVpHbHVaMEp2ZUNJK1BISmxZM1FnZDJsa2RHZzlJakVpSUdobGFXZG9kRDBpTVNJZ1ptbHNiRDBpZFhKc0tDTm5jbUZrTFhWd0tTSWdMejQ4TDIxaGMycytQRzFoYzJzZ2FXUTlJbVpoWkdVdFpHOTNiaUlnYldGemEwTnZiblJsYm5SVmJtbDBjejBpYjJKcVpXTjBRbTkxYm1ScGJtZENiM2dpUGp4eVpXTjBJSGRwWkhSb1BTSXhJaUJvWldsbmFIUTlJakVpSUdacGJHdzlJblZ5YkNnalozSmhaQzFrYjNkdUtTSWdMejQ4TDIxaGMycytQRzFoYzJzZ2FXUTlJbTV2Ym1VaUlHMWhjMnREYjI1MFpXNTBWVzVwZEhNOUltOWlhbVZqZEVKdmRXNWthVzVuUW05NElqNDhjbVZqZENCM2FXUjBhRDBpTVNJZ2FHVnBaMmgwUFNJeElpQm1hV3hzUFNKM2FHbDBaU0lnTHo0OEwyMWhjMnMrUEd4cGJtVmhja2R5WVdScFpXNTBJR2xrUFNKbmNtRmtMWE41YldKdmJDSStQSE4wYjNBZ2IyWm1jMlYwUFNJd0xqY2lJSE4wYjNBdFkyOXNiM0k5SW5kb2FYUmxJaUJ6ZEc5d0xXOXdZV05wZEhrOUlqRWlJQzgrUEhOMGIzQWdiMlptYzJWMFBTSXVPVFVpSUhOMGIzQXRZMjlzYjNJOUluZG9hWFJsSWlCemRHOXdMVzl3WVdOcGRIazlJakFpSUM4K1BDOXNhVzVsWVhKSGNtRmthV1Z1ZEQ0OGJXRnpheUJwWkQwaVptRmtaUzF6ZVcxaWIyd2lJRzFoYzJ0RGIyNTBaVzUwVlc1cGRITTlJblZ6WlhKVGNHRmpaVTl1VlhObElqNDhjbVZqZENCM2FXUjBhRDBpTWprd2NIZ2lJR2hsYVdkb2REMGlNakF3Y0hnaUlHWnBiR3c5SW5WeWJDZ2paM0poWkMxemVXMWliMndwSWlBdlBqd3ZiV0Z6YXo0OEwyUmxabk0rUEdjZ1kyeHBjQzF3WVhSb1BTSjFjbXdvSTJOdmNtNWxjbk1wSWo0OGNtVmpkQ0JtYVd4c1BTSmhNR0k0TmpraUlIZzlJakJ3ZUNJZ2VUMGlNSEI0SWlCM2FXUjBhRDBpTWprd2NIZ2lJR2hsYVdkb2REMGlOVEF3Y0hnaUlDOCtQSEpsWTNRZ2MzUjViR1U5SW1acGJIUmxjam9nZFhKc0tDTm1NU2tpSUhnOUlqQndlQ0lnZVQwaU1IQjRJaUIzYVdSMGFEMGlNamt3Y0hnaUlHaGxhV2RvZEQwaU5UQXdjSGdpSUM4K0lEeG5JSE4wZVd4bFBTSm1hV3gwWlhJNmRYSnNLQ04wYjNBdGNtVm5hVzl1TFdKc2RYSXBPeUIwY21GdWMyWnZjbTA2YzJOaGJHVW9NUzQxS1RzZ2RISmhibk5tYjNKdExXOXlhV2RwYmpwalpXNTBaWElnZEc5d095SStQSEpsWTNRZ1ptbHNiRDBpYm05dVpTSWdlRDBpTUhCNElpQjVQU0l3Y0hnaUlIZHBaSFJvUFNJeU9UQndlQ0lnYUdWcFoyaDBQU0kxTURCd2VDSWdMejQ4Wld4c2FYQnpaU0JqZUQwaU5UQWxJaUJqZVQwaU1IQjRJaUJ5ZUQwaU1UZ3djSGdpSUhKNVBTSXhNakJ3ZUNJZ1ptbHNiRDBpSXpBd01DSWdiM0JoWTJsMGVUMGlNQzQ0TlNJZ0x6NDhMMmMrUEhKbFkzUWdlRDBpTUNJZ2VUMGlNQ0lnZDJsa2RHZzlJakk1TUNJZ2FHVnBaMmgwUFNJMU1EQWlJSEo0UFNJME1pSWdjbms5SWpReUlpQm1hV3hzUFNKeVoySmhLREFzTUN3d0xEQXBJaUJ6ZEhKdmEyVTlJbkpuWW1Fb01qVTFMREkxTlN3eU5UVXNNQzR5S1NJZ0x6NDhMMmMrUEhSbGVIUWdkR1Y0ZEMxeVpXNWtaWEpwYm1jOUltOXdkR2x0YVhwbFUzQmxaV1FpUGp4MFpYaDBVR0YwYUNCemRHRnlkRTltWm5ObGREMGlMVEV3TUNVaUlHWnBiR3c5SW5kb2FYUmxJaUJtYjI1MExXWmhiV2xzZVQwaUowTnZkWEpwWlhJZ1RtVjNKeXdnYlc5dWIzTndZV05sSWlCbWIyNTBMWE5wZW1VOUlqRXdjSGdpSUhoc2FXNXJPbWh5WldZOUlpTjBaWGgwTFhCaGRHZ3RZU0krTUhoak1ESmhZV0V6T1dJeU1qTm1aVGhrTUdFd1pUVmpOR1l5TjJWaFpEa3dPRE5qTnpVMlkyTXlJT0tBb2lCWFJWUklJRHhoYm1sdFlYUmxJR0ZrWkdsMGFYWmxQU0p6ZFcwaUlHRjBkSEpwWW5WMFpVNWhiV1U5SW5OMFlYSjBUMlptYzJWMElpQm1jbTl0UFNJd0pTSWdkRzg5SWpFd01DVWlJR0psWjJsdVBTSXdjeUlnWkhWeVBTSXpNSE1pSUhKbGNHVmhkRU52ZFc1MFBTSnBibVJsWm1sdWFYUmxJaUF2UGp3dmRHVjRkRkJoZEdnK0lEeDBaWGgwVUdGMGFDQnpkR0Z5ZEU5bVpuTmxkRDBpTUNVaUlHWnBiR3c5SW5kb2FYUmxJaUJtYjI1MExXWmhiV2xzZVQwaUowTnZkWEpwWlhJZ1RtVjNKeXdnYlc5dWIzTndZV05sSWlCbWIyNTBMWE5wZW1VOUlqRXdjSGdpSUhoc2FXNXJPbWh5WldZOUlpTjBaWGgwTFhCaGRHZ3RZU0krTUhoak1ESmhZV0V6T1dJeU1qTm1aVGhrTUdFd1pUVmpOR1l5TjJWaFpEa3dPRE5qTnpVMlkyTXlJT0tBb2lCWFJWUklJRHhoYm1sdFlYUmxJR0ZrWkdsMGFYWmxQU0p6ZFcwaUlHRjBkSEpwWW5WMFpVNWhiV1U5SW5OMFlYSjBUMlptYzJWMElpQm1jbTl0UFNJd0pTSWdkRzg5SWpFd01DVWlJR0psWjJsdVBTSXdjeUlnWkhWeVBTSXpNSE1pSUhKbGNHVmhkRU52ZFc1MFBTSnBibVJsWm1sdWFYUmxJaUF2UGlBOEwzUmxlSFJRWVhSb1BqeDBaWGgwVUdGMGFDQnpkR0Z5ZEU5bVpuTmxkRDBpTlRBbElpQm1hV3hzUFNKM2FHbDBaU0lnWm05dWRDMW1ZVzFwYkhrOUlpZERiM1Z5YVdWeUlFNWxkeWNzSUcxdmJtOXpjR0ZqWlNJZ1ptOXVkQzF6YVhwbFBTSXhNSEI0SWlCNGJHbHVhenBvY21WbVBTSWpkR1Y0ZEMxd1lYUm9MV0VpUGpCNFlUQmlPRFk1T1RGak5qSXhPR0l6Tm1NeFpERTVaRFJoTW1VNVpXSXdZMlV6TmpBMlpXSTBPQ0RpZ0tJZ1ZWTkVReUE4WVc1cGJXRjBaU0JoWkdScGRHbDJaVDBpYzNWdElpQmhkSFJ5YVdKMWRHVk9ZVzFsUFNKemRHRnlkRTltWm5ObGRDSWdabkp2YlQwaU1DVWlJSFJ2UFNJeE1EQWxJaUJpWldkcGJqMGlNSE1pSUdSMWNqMGlNekJ6SWlCeVpYQmxZWFJEYjNWdWREMGlhVzVrWldacGJtbDBaU0lnTHo0OEwzUmxlSFJRWVhSb1BqeDBaWGgwVUdGMGFDQnpkR0Z5ZEU5bVpuTmxkRDBpTFRVd0pTSWdabWxzYkQwaWQyaHBkR1VpSUdadmJuUXRabUZ0YVd4NVBTSW5RMjkxY21sbGNpQk9aWGNuTENCdGIyNXZjM0JoWTJVaUlHWnZiblF0YzJsNlpUMGlNVEJ3ZUNJZ2VHeHBibXM2YUhKbFpqMGlJM1JsZUhRdGNHRjBhQzFoSWo0d2VHRXdZamcyT1RreFl6WXlNVGhpTXpaak1XUXhPV1EwWVRKbE9XVmlNR05sTXpZd05tVmlORGdnNG9DaUlGVlRSRU1nUEdGdWFXMWhkR1VnWVdSa2FYUnBkbVU5SW5OMWJTSWdZWFIwY21saWRYUmxUbUZ0WlQwaWMzUmhjblJQWm1aelpYUWlJR1p5YjIwOUlqQWxJaUIwYnowaU1UQXdKU0lnWW1WbmFXNDlJakJ6SWlCa2RYSTlJak13Y3lJZ2NtVndaV0YwUTI5MWJuUTlJbWx1WkdWbWFXNXBkR1VpSUM4K1BDOTBaWGgwVUdGMGFENDhMM1JsZUhRK1BHY2diV0Z6YXowaWRYSnNLQ05tWVdSbExYTjViV0p2YkNraVBqeHlaV04wSUdacGJHdzlJbTV2Ym1VaUlIZzlJakJ3ZUNJZ2VUMGlNSEI0SWlCM2FXUjBhRDBpTWprd2NIZ2lJR2hsYVdkb2REMGlNakF3Y0hnaUlDOCtJRHgwWlhoMElIazlJamN3Y0hnaUlIZzlJak15Y0hnaUlHWnBiR3c5SW5kb2FYUmxJaUJtYjI1MExXWmhiV2xzZVQwaUowTnZkWEpwWlhJZ1RtVjNKeXdnYlc5dWIzTndZV05sSWlCbWIyNTBMWGRsYVdkb2REMGlNakF3SWlCbWIyNTBMWE5wZW1VOUlqTTJjSGdpUGxWVFJFTXZWMFZVU0R3dmRHVjRkRDQ4ZEdWNGRDQjVQU0l4TVRWd2VDSWdlRDBpTXpKd2VDSWdabWxzYkQwaWQyaHBkR1VpSUdadmJuUXRabUZ0YVd4NVBTSW5RMjkxY21sbGNpQk9aWGNuTENCdGIyNXZjM0JoWTJVaUlHWnZiblF0ZDJWcFoyaDBQU0l5TURBaUlHWnZiblF0YzJsNlpUMGlNelp3ZUNJK01DNHdOU1U4TDNSbGVIUStQQzluUGp4eVpXTjBJSGc5SWpFMklpQjVQU0l4TmlJZ2QybGtkR2c5SWpJMU9DSWdhR1ZwWjJoMFBTSTBOamdpSUhKNFBTSXlOaUlnY25rOUlqSTJJaUJtYVd4c1BTSnlaMkpoS0RBc01Dd3dMREFwSWlCemRISnZhMlU5SW5KblltRW9NalUxTERJMU5Td3lOVFVzTUM0eUtTSWdMejQ4WnlCdFlYTnJQU0oxY213b0kyNXZibVVwSWlCemRIbHNaVDBpZEhKaGJuTm1iM0p0T25SeVlXNXpiR0YwWlNnM01uQjRMREU0T1hCNEtTSStQSEpsWTNRZ2VEMGlMVEUyY0hnaUlIazlJaTB4Tm5CNElpQjNhV1IwYUQwaU1UZ3djSGdpSUdobGFXZG9kRDBpTVRnd2NIZ2lJR1pwYkd3OUltNXZibVVpSUM4K1BIQmhkR2dnWkQwaVRURWdNVU14TnlBM015QTNNeUF4TWprZ01UUTFJREUwTlNJZ2MzUnliMnRsUFNKeVoySmhLREFzTUN3d0xEQXVNeWtpSUhOMGNtOXJaUzEzYVdSMGFEMGlNekp3ZUNJZ1ptbHNiRDBpYm05dVpTSWdjM1J5YjJ0bExXeHBibVZqWVhBOUluSnZkVzVrSWlBdlBqd3ZaejQ4WnlCdFlYTnJQU0oxY213b0kyNXZibVVwSWlCemRIbHNaVDBpZEhKaGJuTm1iM0p0T25SeVlXNXpiR0YwWlNnM01uQjRMREU0T1hCNEtTSStQSEpsWTNRZ2VEMGlMVEUyY0hnaUlIazlJaTB4Tm5CNElpQjNhV1IwYUQwaU1UZ3djSGdpSUdobGFXZG9kRDBpTVRnd2NIZ2lJR1pwYkd3OUltNXZibVVpSUM4K1BIQmhkR2dnWkQwaVRURWdNVU14TnlBM015QTNNeUF4TWprZ01UUTFJREUwTlNJZ2MzUnliMnRsUFNKeVoySmhLREkxTlN3eU5UVXNNalUxTERFcElpQm1hV3hzUFNKdWIyNWxJaUJ6ZEhKdmEyVXRiR2x1WldOaGNEMGljbTkxYm1RaUlDOCtQQzluUGp4amFYSmpiR1VnWTNnOUlqY3pjSGdpSUdONVBTSXhPVEJ3ZUNJZ2NqMGlOSEI0SWlCbWFXeHNQU0ozYUdsMFpTSWdMejQ4WTJseVkyeGxJR040UFNJeU1UZHdlQ0lnWTNrOUlqTXpOSEI0SWlCeVBTSTBjSGdpSUdacGJHdzlJbmRvYVhSbElpQXZQaUE4WnlCemRIbHNaVDBpZEhKaGJuTm1iM0p0T25SeVlXNXpiR0YwWlNneU9YQjRMQ0F6T0RSd2VDa2lQanh5WldOMElIZHBaSFJvUFNJNU9IQjRJaUJvWldsbmFIUTlJakkyY0hnaUlISjRQU0k0Y0hnaUlISjVQU0k0Y0hnaUlHWnBiR3c5SW5KblltRW9NQ3d3TERBc01DNDJLU0lnTHo0OGRHVjRkQ0I0UFNJeE1uQjRJaUI1UFNJeE4zQjRJaUJtYjI1MExXWmhiV2xzZVQwaUowTnZkWEpwWlhJZ1RtVjNKeXdnYlc5dWIzTndZV05sSWlCbWIyNTBMWE5wZW1VOUlqRXljSGdpSUdacGJHdzlJbmRvYVhSbElqNDhkSE53WVc0Z1ptbHNiRDBpY21kaVlTZ3lOVFVzTWpVMUxESTFOU3d3TGpZcElqNUpSRG9nUEM5MGMzQmhiajQxTVRVMk16TThMM1JsZUhRK1BDOW5QaUE4WnlCemRIbHNaVDBpZEhKaGJuTm1iM0p0T25SeVlXNXpiR0YwWlNneU9YQjRMQ0EwTVRSd2VDa2lQanh5WldOMElIZHBaSFJvUFNJeE5EQndlQ0lnYUdWcFoyaDBQU0l5Tm5CNElpQnllRDBpT0hCNElpQnllVDBpT0hCNElpQm1hV3hzUFNKeVoySmhLREFzTUN3d0xEQXVOaWtpSUM4K1BIUmxlSFFnZUQwaU1USndlQ0lnZVQwaU1UZHdlQ0lnWm05dWRDMW1ZVzFwYkhrOUlpZERiM1Z5YVdWeUlFNWxkeWNzSUcxdmJtOXpjR0ZqWlNJZ1ptOXVkQzF6YVhwbFBTSXhNbkI0SWlCbWFXeHNQU0ozYUdsMFpTSStQSFJ6Y0dGdUlHWnBiR3c5SW5KblltRW9NalUxTERJMU5Td3lOVFVzTUM0MktTSStUV2x1SUZScFkyczZJRHd2ZEhOd1lXNCtNakF3TlRjd1BDOTBaWGgwUGp3dlp6NGdQR2NnYzNSNWJHVTlJblJ5WVc1elptOXliVHAwY21GdWMyeGhkR1VvTWpsd2VDd2dORFEwY0hncElqNDhjbVZqZENCM2FXUjBhRDBpTVRRd2NIZ2lJR2hsYVdkb2REMGlNalp3ZUNJZ2NuZzlJamh3ZUNJZ2NuazlJamh3ZUNJZ1ptbHNiRDBpY21kaVlTZ3dMREFzTUN3d0xqWXBJaUF2UGp4MFpYaDBJSGc5SWpFeWNIZ2lJSGs5SWpFM2NIZ2lJR1p2Ym5RdFptRnRhV3g1UFNJblEyOTFjbWxsY2lCT1pYY25MQ0J0YjI1dmMzQmhZMlVpSUdadmJuUXRjMmw2WlQwaU1USndlQ0lnWm1sc2JEMGlkMmhwZEdVaVBqeDBjM0JoYmlCbWFXeHNQU0p5WjJKaEtESTFOU3d5TlRVc01qVTFMREF1TmlraVBrMWhlQ0JVYVdOck9pQThMM1J6Y0dGdVBqSXdNVEV4TUR3dmRHVjRkRDQ4TDJjK1BHY2djM1I1YkdVOUluUnlZVzV6Wm05eWJUcDBjbUZ1YzJ4aGRHVW9NakkyY0hnc0lEUXpNM0I0S1NJK1BISmxZM1FnZDJsa2RHZzlJak0yY0hnaUlHaGxhV2RvZEQwaU16WndlQ0lnY25nOUlqaHdlQ0lnY25rOUlqaHdlQ0lnWm1sc2JEMGlibTl1WlNJZ2MzUnliMnRsUFNKeVoySmhLREkxTlN3eU5UVXNNalUxTERBdU1pa2lJQzgrUEhCaGRHZ2djM1J5YjJ0bExXeHBibVZqWVhBOUluSnZkVzVrSWlCa1BTSk5PQ0E1UXpndU1EQXdNRFFnTWpJdU9UUTVOQ0F4Tmk0eU1EazVJREk0SURJM0lESTRJaUJtYVd4c1BTSnViMjVsSWlCemRISnZhMlU5SW5kb2FYUmxJaUF2UGp4amFYSmpiR1VnYzNSNWJHVTlJblJ5WVc1elptOXliVHAwY21GdWMyeGhkR1V6WkNneU5IQjRMQ0F5TjNCNExDQXdjSGdwSWlCamVEMGlNSEI0SWlCamVUMGlNSEI0SWlCeVBTSTBjSGdpSUdacGJHdzlJbmRvYVhSbElpOCtQQzluUGp3dmMzWm5QZz09In0=",
						},
					},
					{
						Type:     filter.TypeExchangeLiquidity,
						Platform: filter.PlatformUniswap.String(),
						From:     "0x36E5A96c8d01803d2C48756AA7bde1c01d7D9f8A",
						To:       uniswap.AddressNonfungiblePositionManager.String(),
						Metadata: metadata.ExchangeLiquidity{
							Action: metadata.ActionExchangeLiquidityAdd,
							Tokens: []metadata.Token{
								{
									Address:  lo.ToPtr("0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"),
									Value:    lo.ToPtr(lo.Must(decimal.NewFromString("536319502110"))),
									Name:     "USD Coin",
									Symbol:   "USDC",
									Decimals: 6,
									Standard: metadata.StandardERC20,
								},
								{
									Address:  lo.ToPtr("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
									Value:    lo.ToPtr(lo.Must(decimal.NewFromString("271996150995763839308"))),
									Name:     "Wrapped Ether",
									Symbol:   "WETH",
									Decimals: 18,
									Standard: metadata.StandardERC20,
								},
							},
						},
					},
				},
				Status:    true,
				Timestamp: 1685412191,
			},
			wantError: require.NoError,
		},
		{
			name: "Remove cbETH and WETH liquidity from Uniswap Nonfungible Position Manager",
			arguments: arguments{
				task: &source.Task{
					Network: filter.NetworkEthereum,
					ChainID: 1,
					Header: &ethereum.Header{
						Hash:         common.HexToHash("0xa7b709890eadb66d9abfb29269de27ff60d0264a584a5a2ffc0e235db80c5a57"),
						ParentHash:   common.HexToHash("0x3f58452390d36aea9c56ac17a0b7c6a97e5ceb0a0079baec52ceab0ba310c55f"),
						UncleHash:    common.HexToHash("0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347"),
						Coinbase:     common.HexToAddress("0xDAFEA492D9c6733ae3d56b7Ed1ADB60692c98Bc5"),
						Number:       lo.Must(new(big.Int).SetString("17369296", 0)),
						GasLimit:     30000000,
						GasUsed:      18555460,
						Timestamp:    1685419931,
						BaseFee:      lo.Must(new(big.Int).SetString("56221583312", 0)),
						Transactions: nil,
					},
					Transaction: &ethereum.Transaction{
						BlockHash: common.HexToHash("0x1da1d585513eb27ac32020046e3b39b114311e934243b497a1af5be25e959410"),
						From:      common.HexToAddress("0x8E02247D3eE0E6153495c971FFd45Aa131f4D7cB"),
						Gas:       384962,
						GasPrice:  lo.Must(new(big.Int).SetString("56321583312", 10)),
						Hash:      common.HexToHash("0x1da1d585513eb27ac32020046e3b39b114311e934243b497a1af5be25e959410"),
						Input:     hexutil.MustDecode("0xac9650d80000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000800000000000000000000000000000000000000000000000000000000000000160000000000000000000000000000000000000000000000000000000000000022000000000000000000000000000000000000000000000000000000000000002a000000000000000000000000000000000000000000000000000000000000000a40c49ccbe000000000000000000000000000000000000000000000000000000000007bf3e000000000000000000000000000000000000000000001080bf78119c9f0f648a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000064757c33000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000084fc6f7865000000000000000000000000000000000000000000000000000000000007bf3e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffff00000000000000000000000000000000ffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004449404b7c0000000000000000000000000000000000000000000000000237f2ba8ee880060000000000000000000000008e02247d3ee0e6153495c971ffd45aa131f4d7cb000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000064df2ab5bb000000000000000000000000be9895146f7af43049ca1c1ae358b0541ea4970400000000000000000000000000000000000000000000000001c897fd3422357b0000000000000000000000008e02247d3ee0e6153495c971ffd45aa131f4d7cb00000000000000000000000000000000000000000000000000000000"),
						To:        lo.ToPtr(common.HexToAddress("0xC36442b4a4522E871399CD717aBDD847Ab11FE88")),
						Value:     lo.Must(new(big.Int).SetString("0", 0)),
						Type:      2,
						ChainID:   lo.Must(new(big.Int).SetString("1", 0)),
					},
					Receipt: &ethereum.Receipt{
						BlockHash:         common.HexToHash("0xa7b709890eadb66d9abfb29269de27ff60d0264a584a5a2ffc0e235db80c5a57"),
						BlockNumber:       lo.Must(new(big.Int).SetString("17369296", 0)),
						ContractAddress:   nil,
						CumulativeGasUsed: 12612114,
						EffectiveGasPrice: hexutil.MustDecodeBig("0xd1d0728d0"),
						GasUsed:           256642,
						Logs: []*ethereum.Log{
							{
								Address: common.HexToAddress("0x840DEEef2f115Cf50DA625F7368C24af6fE74410"),
								Topics: []common.Hash{
									common.HexToHash("0x0c396cd989a39f4459b5fa1aed6a9a8dcdbc45908acfd67e028cd568da98982c"),
									common.HexToHash("0x000000000000000000000000c36442b4a4522e871399cd717abdd847ab11fe88"),
									common.HexToHash("0x0000000000000000000000000000000000000000000000000000000000000140"),
									common.HexToHash("0x0000000000000000000000000000000000000000000000000000000000000168"),
								},
								Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000001080bf78119c9f0f648a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008980bc58516d874b7"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17369296", 0)),
								TransactionHash: common.HexToHash("0x1da1d585513eb27ac32020046e3b39b114311e934243b497a1af5be25e959410"),
								Index:           284,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xC36442b4a4522E871399CD717aBDD847Ab11FE88"),
								Topics: []common.Hash{
									common.HexToHash("0x26f6a048ee9138f2c0ce266f322cb99228e8d619ae2bff30c67f8dcf9d2377b4"),
									common.HexToHash("0x000000000000000000000000000000000000000000000000000000000007bf3e"),
								},
								Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000001080bf78119c9f0f648a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008980bc58516d874b7"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17369296", 0)),
								TransactionHash: common.HexToHash("0x1da1d585513eb27ac32020046e3b39b114311e934243b497a1af5be25e959410"),
								Index:           285,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xBe9895146f7AF43049ca1c1AE358B0541Ea49704"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000840deeef2f115cf50da625f7368c24af6fe74410"),
									common.HexToHash("0x000000000000000000000000c36442b4a4522e871399cd717abdd847ab11fe88"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000001c897fd3422357b"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17369296", 0)),
								TransactionHash: common.HexToHash("0x1da1d585513eb27ac32020046e3b39b114311e934243b497a1af5be25e959410"),
								Index:           286,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000840deeef2f115cf50da625f7368c24af6fe74410"),
									common.HexToHash("0x000000000000000000000000c36442b4a4522e871399cd717abdd847ab11fe88"),
								},
								Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000089a43b83fa5c0f4bd"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17369296", 0)),
								TransactionHash: common.HexToHash("0x1da1d585513eb27ac32020046e3b39b114311e934243b497a1af5be25e959410"),
								Index:           287,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0x840DEEef2f115Cf50DA625F7368C24af6fE74410"),
								Topics: []common.Hash{
									common.HexToHash("0x70935338e69775456a85ddef226c395fb668b63fa0115f5f20610b388e6ca9c0"),
									common.HexToHash("0x000000000000000000000000c36442b4a4522e871399cd717abdd847ab11fe88"),
									common.HexToHash("0x0000000000000000000000000000000000000000000000000000000000000140"),
									common.HexToHash("0x0000000000000000000000000000000000000000000000000000000000000168"),
								},
								Data:            hexutil.MustDecode("0x000000000000000000000000c36442b4a4522e871399cd717abdd847ab11fe8800000000000000000000000000000000000000000000000001c897fd3422357b0000000000000000000000000000000000000000000000089a43b83fa5c0f4bd"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17369296", 0)),
								TransactionHash: common.HexToHash("0x1da1d585513eb27ac32020046e3b39b114311e934243b497a1af5be25e959410"),
								Index:           288,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xC36442b4a4522E871399CD717aBDD847Ab11FE88"),
								Topics: []common.Hash{
									common.HexToHash("0x40d0efd1a53d60ecbf40971b9daf7dc90178c3aadc7aab1765632738fa8b8f01"),
									common.HexToHash("0x000000000000000000000000000000000000000000000000000000000007bf3e"),
								},
								Data:            hexutil.MustDecode("0x000000000000000000000000c36442b4a4522e871399cd717abdd847ab11fe8800000000000000000000000000000000000000000000000001c897fd3422357b0000000000000000000000000000000000000000000000089a43b83fa5c0f4bd"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17369296", 0)),
								TransactionHash: common.HexToHash("0x1da1d585513eb27ac32020046e3b39b114311e934243b497a1af5be25e959410"),
								Index:           289,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
								Topics: []common.Hash{
									common.HexToHash("0x7fcf532c15f0a6db0bd6d0e038bea71d30d808c7d98cb3bf7268a95bf5081b65"),
									common.HexToHash("0x000000000000000000000000c36442b4a4522e871399cd717abdd847ab11fe88"),
								},
								Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000089a43b83fa5c0f4bd"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17369296", 0)),
								TransactionHash: common.HexToHash("0x1da1d585513eb27ac32020046e3b39b114311e934243b497a1af5be25e959410"),
								Index:           290,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xBe9895146f7AF43049ca1c1AE358B0541Ea49704"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000c36442b4a4522e871399cd717abdd847ab11fe88"),
									common.HexToHash("0x0000000000000000000000008e02247d3ee0e6153495c971ffd45aa131f4d7cb"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000001c897fd3422357b"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17369296", 0)),
								TransactionHash: common.HexToHash("0x1da1d585513eb27ac32020046e3b39b114311e934243b497a1af5be25e959410"),
								Index:           291,
								Removed:         false,
							},
						},
						Status:           1,
						TransactionHash:  common.HexToHash("0x1da1d585513eb27ac32020046e3b39b114311e934243b497a1af5be25e959410"),
						TransactionIndex: 222,
					},
				},
				config: &config.Module{
					Network:  filter.NetworkEthereum,
					Endpoint: endpoint.MustGet(filter.NetworkEthereum),
				},
			},
			want: &schema.Feed{
				ID:      "0x1da1d585513eb27ac32020046e3b39b114311e934243b497a1af5be25e959410",
				Network: filter.NetworkEthereum,
				Index:   222,
				From:    "0x8E02247D3eE0E6153495c971FFd45Aa131f4D7cB",
				To:      uniswap.AddressNonfungiblePositionManager.String(),
				Type:    filter.TypeExchangeLiquidity,
				Calldata: &schema.Calldata{
					FunctionHash: "0xac9650d8",
				},
				Platform: lo.ToPtr(filter.PlatformUniswap),
				Fee: &schema.Fee{
					Amount:  lo.Must(decimal.NewFromString("14454483784358304")),
					Decimal: 18,
				},
				Actions: []*schema.Action{
					{
						Type:     filter.TypeExchangeLiquidity,
						Platform: filter.PlatformUniswap.String(),
						From:     uniswap.AddressNonfungiblePositionManager.String(),
						To:       "0x8E02247D3eE0E6153495c971FFd45Aa131f4D7cB",
						Metadata: metadata.ExchangeLiquidity{
							Action: metadata.ActionExchangeLiquidityRemove,
							Tokens: []metadata.Token{
								{
									Address:  lo.ToPtr("0xBe9895146f7AF43049ca1c1AE358B0541Ea49704"),
									Value:    lo.ToPtr(lo.Must(decimal.NewFromString("0"))),
									Name:     "Coinbase Wrapped Staked ETH",
									Symbol:   "cbETH",
									Decimals: 18,
									Standard: metadata.StandardERC20,
								},
								{
									Address:  lo.ToPtr("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
									Value:    lo.ToPtr(lo.Must(decimal.NewFromString("158530020283589883063"))),
									Name:     "Wrapped Ether",
									Symbol:   "WETH",
									Decimals: 18,
									Standard: metadata.StandardERC20,
								},
							},
						},
					},
					{
						Type:     filter.TypeExchangeLiquidity,
						Platform: filter.PlatformUniswap.String(),
						From:     uniswap.AddressNonfungiblePositionManager.String(),
						To:       "0x8E02247D3eE0E6153495c971FFd45Aa131f4D7cB",
						Metadata: metadata.ExchangeLiquidity{
							Action: metadata.ActionExchangeLiquidityCollect,
							Tokens: []metadata.Token{
								{
									Address:  lo.ToPtr("0xBe9895146f7AF43049ca1c1AE358B0541Ea49704"),
									Value:    lo.ToPtr(lo.Must(decimal.NewFromString("128519703137236347"))),
									Name:     "Coinbase Wrapped Staked ETH",
									Symbol:   "cbETH",
									Decimals: 18,
									Standard: metadata.StandardERC20,
								},
								{
									Address:  lo.ToPtr("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
									Value:    lo.ToPtr(lo.Must(decimal.NewFromString("158689883478460265661"))),
									Name:     "Wrapped Ether",
									Symbol:   "WETH",
									Decimals: 18,
									Standard: metadata.StandardERC20,
								},
							},
						},
					},
				},
				Status:    true,
				Timestamp: 1685419931,
			},
			wantError: require.NoError,
		},
		{
			name: "Migrate DAI and ETH liquidity from Uniswap V2 Pair to Uniswap V3 Pool",
			arguments: arguments{
				task: &source.Task{
					Network: filter.NetworkEthereum,
					ChainID: 1,
					Header: &ethereum.Header{
						Hash:         common.HexToHash("0x4b00d4e7a4866d94035f418d3e041aa5c3470edf770988418059fb4f72ae3c1a"),
						ParentHash:   common.HexToHash("0x9cd8f73c3592d129620513798d01b8a1a2baced721d0a4b2b1a210c3918ceecc"),
						UncleHash:    common.HexToHash("0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347"),
						Coinbase:     common.HexToAddress("0xDAFEA492D9c6733ae3d56b7Ed1ADB60692c98Bc5"),
						Number:       lo.Must(new(big.Int).SetString("17336353", 0)),
						GasLimit:     30000000,
						GasUsed:      14174404,
						Timestamp:    1685020067,
						BaseFee:      lo.Must(new(big.Int).SetString("45065032609", 0)),
						Transactions: nil,
					},
					Transaction: &ethereum.Transaction{
						BlockHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
						From:      common.HexToAddress("0xf69A8916669De197E84Cb39A38bA5115e8efCC77"),
						Gas:       830961,
						GasPrice:  lo.Must(new(big.Int).SetString("45165032609", 10)),
						Hash:      common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
						Input:     hexutil.MustDecode("0xac9650d8000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000040000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000000c4f3995c67000000000000000000000000a478c2975ab1ea89e8196811f51a7b7ade33eb1100000000000000000000000000000000000000000000000a83ffa947500b0bc900000000000000000000000000000000000000000000000000000000646f6937000000000000000000000000000000000000000000000000000000000000001bddcabffa51f713a791723b093c45aefd9ab225a5bd2cdb95b7612332f40139a039630e26111b8e6c476516b19bb755b0b6e4b0b55773e30dbd7418bc98c4fc760000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001a4d44f2bf2000000000000000000000000a478c2975ab1ea89e8196811f51a7b7ade33eb1100000000000000000000000000000000000000000000000a83ffa947500b0bc900000000000000000000000000000000000000000000000000000000000000640000000000000000000000006b175474e89094c44da98b954eedeac495271d0f000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000000000000000000000000000000000000000000bb8fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffebbdcfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffefaac0000000000000000000000000000000000000000000003256f234ea3013e503900000000000000000000000000000000000000000000000071d28d743f457ea5000000000000000000000000f69a8916669de197e84cb39a38ba5115e8efcc7700000000000000000000000000000000000000000000000000000000646f6937000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000"),
						To:        lo.ToPtr(common.HexToAddress("0xA5644E29708357803b5A882D272c41cC0dF92B34")),
						Value:     lo.Must(new(big.Int).SetString("0", 0)),
						Type:      2,
						ChainID:   lo.Must(new(big.Int).SetString("1", 0)),
					},
					Receipt: &ethereum.Receipt{
						BlockHash:         common.HexToHash("0x4b00d4e7a4866d94035f418d3e041aa5c3470edf770988418059fb4f72ae3c1a"),
						BlockNumber:       lo.Must(new(big.Int).SetString("17336353", 0)),
						ContractAddress:   nil,
						CumulativeGasUsed: 8492545,
						EffectiveGasPrice: hexutil.MustDecodeBig("0xa840bb4a1"),
						GasUsed:           560928,
						Logs: []*ethereum.Log{
							{
								Address: common.HexToAddress("0xA478c2975Ab1Ea89e8196811F51A7B7Ade33eB11"),
								Topics: []common.Hash{
									common.HexToHash("0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925"),
									common.HexToHash("0x000000000000000000000000f69a8916669de197e84cb39a38ba5115e8efcc77"),
									common.HexToHash("0x000000000000000000000000a5644e29708357803b5a882d272c41cc0df92b34"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000a83ffa947500b0bc9"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17336353", 0)),
								TransactionHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
								Index:           202,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xA478c2975Ab1Ea89e8196811F51A7B7Ade33eB11"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000f69a8916669de197e84cb39a38ba5115e8efcc77"),
									common.HexToHash("0x000000000000000000000000a478c2975ab1ea89e8196811f51a7b7ade33eb11"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000a83ffa947500b0bc9"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17336353", 0)),
								TransactionHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
								Index:           203,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xA478c2975Ab1Ea89e8196811F51A7B7Ade33eB11"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000a478c2975ab1ea89e8196811f51a7b7ade33eb11"),
									common.HexToHash("0x0000000000000000000000000000000000000000000000000000000000000000"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000a83ffa947500b0bc9"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17336353", 0)),
								TransactionHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
								Index:           204,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0x6B175474E89094C44Da98b954EedeAC495271d0F"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000a478c2975ab1ea89e8196811f51a7b7ade33eb11"),
									common.HexToHash("0x000000000000000000000000a5644e29708357803b5a882d272c41cc0df92b34"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000032e919c9e2643a96a35"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17336353", 0)),
								TransactionHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
								Index:           205,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000a478c2975ab1ea89e8196811f51a7b7ade33eb11"),
									common.HexToHash("0x000000000000000000000000a5644e29708357803b5a882d272c41cc0df92b34"),
								},
								Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000739b809eed260661"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17336353", 0)),
								TransactionHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
								Index:           206,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xA478c2975Ab1Ea89e8196811F51A7B7Ade33eB11"),
								Topics: []common.Hash{
									common.HexToHash("0x1c411e9a96e071241c2f21f7726b17ae89e3cab4c78be50e062b03a9fffbbad1"),
								},
								Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000644de6084cf4f442843520000000000000000000000000000000000000000000000e3c53f9be267974261"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17336353", 0)),
								TransactionHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
								Index:           207,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xA478c2975Ab1Ea89e8196811F51A7B7Ade33eB11"),
								Topics: []common.Hash{
									common.HexToHash("0xdccd412f0b1252819cb1fd330b93224ca42612892bb3f4f789976e6d81936496"),
									common.HexToHash("0x000000000000000000000000a5644e29708357803b5a882d272c41cc0df92b34"),
									common.HexToHash("0x000000000000000000000000a5644e29708357803b5a882d272c41cc0df92b34"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000032e919c9e2643a96a35000000000000000000000000000000000000000000000000739b809eed260661"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17336353", 0)),
								TransactionHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
								Index:           208,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0x6B175474E89094C44Da98b954EedeAC495271d0F"),
								Topics: []common.Hash{
									common.HexToHash("0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925"),
									common.HexToHash("0x000000000000000000000000a5644e29708357803b5a882d272c41cc0df92b34"),
									common.HexToHash("0x000000000000000000000000c36442b4a4522e871399cd717abdd847ab11fe88"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000032e919c9e2643a96a35"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17336353", 0)),
								TransactionHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
								Index:           209,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
								Topics: []common.Hash{
									common.HexToHash("0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925"),
									common.HexToHash("0x000000000000000000000000a5644e29708357803b5a882d272c41cc0df92b34"),
									common.HexToHash("0x000000000000000000000000c36442b4a4522e871399cd717abdd847ab11fe88"),
								},
								Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000739b809eed260661"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17336353", 0)),
								TransactionHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
								Index:           210,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0x6B175474E89094C44Da98b954EedeAC495271d0F"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000a5644e29708357803b5a882d272c41cc0df92b34"),
									common.HexToHash("0x000000000000000000000000c2e9f25be6257c210d7adf0d4cd6e3e881ba25f8"),
								},
								Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000032e919c9e2643a96a2b"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17336353", 0)),
								TransactionHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
								Index:           211,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000a5644e29708357803b5a882d272c41cc0df92b34"),
									common.HexToHash("0x000000000000000000000000c2e9f25be6257c210d7adf0d4cd6e3e881ba25f8"),
								},
								Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000732161b20c68e1ff"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17336353", 0)),
								TransactionHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
								Index:           212,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xC2e9F25Be6257c210d7Adf0D4Cd6E3E881ba25f8"),
								Topics: []common.Hash{
									common.HexToHash("0x7a53080ba414158be7ec69b987b5fb7d07dee101fe85488f0853ae16239d0bde"),
									common.HexToHash("0x000000000000000000000000c36442b4a4522e871399cd717abdd847ab11fe88"),
									common.HexToHash("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffebbdc"),
									common.HexToHash("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffffffefaac"),
								},
								Data:            hexutil.MustDecode("0x000000000000000000000000c36442b4a4522e871399cd717abdd847ab11fe88000000000000000000000000000000000000000000000039d2dc6f2d314c4d1600000000000000000000000000000000000000000000032e919c9e2643a96a2b000000000000000000000000000000000000000000000000732161b20c68e1ff"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17336353", 0)),
								TransactionHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
								Index:           213,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xC36442b4a4522E871399CD717aBDD847Ab11FE88"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x0000000000000000000000000000000000000000000000000000000000000000"),
									common.HexToHash("0x000000000000000000000000f69a8916669de197e84cb39a38ba5115e8efcc77"),
									common.HexToHash("0x000000000000000000000000000000000000000000000000000000000007d319"),
								},
								Data:            nil,
								BlockNumber:     lo.Must(new(big.Int).SetString("17336353", 0)),
								TransactionHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
								Index:           214,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xC36442b4a4522E871399CD717aBDD847Ab11FE88"),
								Topics: []common.Hash{
									common.HexToHash("0x3067048beee31b25b2f1681f88dac838c8bba36af25bfb2b7cf7473a5847e35f"),
									common.HexToHash("0x000000000000000000000000000000000000000000000000000000000007d319"),
								},
								Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000039d2dc6f2d314c4d1600000000000000000000000000000000000000000000032e919c9e2643a96a2b000000000000000000000000000000000000000000000000732161b20c68e1ff"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17336353", 0)),
								TransactionHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
								Index:           215,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0x6B175474E89094C44Da98b954EedeAC495271d0F"),
								Topics: []common.Hash{
									common.HexToHash("0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925"),
									common.HexToHash("0x000000000000000000000000a5644e29708357803b5a882d272c41cc0df92b34"),
									common.HexToHash("0x000000000000000000000000c36442b4a4522e871399cd717abdd847ab11fe88"),
								},
								Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000000000000000000"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17336353", 0)),
								TransactionHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
								Index:           216,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0x6B175474E89094C44Da98b954EedeAC495271d0F"),
								Topics: []common.Hash{
									common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
									common.HexToHash("0x000000000000000000000000a5644e29708357803b5a882d272c41cc0df92b34"),
									common.HexToHash("0x000000000000000000000000f69a8916669de197e84cb39a38ba5115e8efcc77"),
								},
								Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000000000000000000a"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17336353", 0)),
								TransactionHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
								Index:           217,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
								Topics: []common.Hash{
									common.HexToHash("0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925"),
									common.HexToHash("0x000000000000000000000000a5644e29708357803b5a882d272c41cc0df92b34"),
									common.HexToHash("0x000000000000000000000000c36442b4a4522e871399cd717abdd847ab11fe88"),
								},
								Data:            hexutil.MustDecode("0x0000000000000000000000000000000000000000000000000000000000000000"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17336353", 0)),
								TransactionHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
								Index:           218,
								Removed:         false,
							},
							{
								Address: common.HexToAddress("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
								Topics: []common.Hash{
									common.HexToHash("0x7fcf532c15f0a6db0bd6d0e038bea71d30d808c7d98cb3bf7268a95bf5081b65"),
									common.HexToHash("0x000000000000000000000000a5644e29708357803b5a882d272c41cc0df92b34"),
								},
								Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000007a1eece0bd2462"),
								BlockNumber:     lo.Must(new(big.Int).SetString("17336353", 0)),
								TransactionHash: common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
								Index:           219,
								Removed:         false,
							},
						},
						Status:           1,
						TransactionHash:  common.HexToHash("0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864"),
						TransactionIndex: 90,
					},
				},
				config: &config.Module{
					Network:  filter.NetworkEthereum,
					Endpoint: endpoint.MustGet(filter.NetworkEthereum),
				},
			},
			want: &schema.Feed{
				ID:      "0xbf77b991e7a17fbf5da6089f9a27ff2805d63b8d0b18ff48e1d6e118404a7864",
				Network: filter.NetworkEthereum,
				Index:   90,
				From:    "0xf69A8916669De197E84Cb39A38bA5115e8efCC77",
				To:      uniswap.AddressV3Migrator.String(),
				Type:    filter.TypeExchangeLiquidity,
				Calldata: &schema.Calldata{
					FunctionHash: "0xac9650d8",
				},
				Platform: lo.ToPtr(filter.PlatformUniswap),
				Fee: &schema.Fee{
					Amount:  lo.Must(decimal.NewFromString("25334331411301152")),
					Decimal: 18,
				},
				Actions: []*schema.Action{
					{
						Type:     filter.TypeExchangeLiquidity,
						Platform: filter.PlatformUniswap.String(),
						From:     "0xA478c2975Ab1Ea89e8196811F51A7B7Ade33eB11",
						To:       "0xf69A8916669De197E84Cb39A38bA5115e8efCC77",
						Metadata: metadata.ExchangeLiquidity{
							Action: metadata.ActionExchangeLiquidityRemove,
							Tokens: []metadata.Token{
								{
									Address:  lo.ToPtr("0x6B175474E89094C44Da98b954EedeAC495271d0F"),
									Value:    lo.ToPtr(lo.Must(decimal.NewFromString("15026142111118622550581"))),
									Name:     "Dai Stablecoin",
									Symbol:   "DAI",
									Decimals: 18,
									Standard: metadata.StandardERC20,
								},
								{
									Address:  lo.ToPtr("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
									Value:    lo.ToPtr(lo.Must(decimal.NewFromString("8330393355823744609"))),
									Name:     "Wrapped Ether",
									Symbol:   "WETH",
									Decimals: 18,
									Standard: metadata.StandardERC20,
								},
							},
						},
					},
					{
						Type:     filter.TypeTransactionMint,
						Platform: filter.PlatformUniswap.String(),
						From:     "0x0000000000000000000000000000000000000000",
						To:       "0xf69A8916669De197E84Cb39A38bA5115e8efCC77",
						Metadata: metadata.TransactionTransfer{
							Address:  lo.ToPtr("0xC36442b4a4522E871399CD717aBDD847Ab11FE88"),
							ID:       lo.ToPtr(decimal.NewFromInt(512793)),
							Value:    lo.ToPtr(decimal.NewFromInt(1)),
							Name:     "Uniswap V3 Positions NFT-V1",
							Symbol:   "UNI-V3-POS",
							Standard: metadata.StandardERC721,
							URI:      "data:application/json;base64,eyJuYW1lIjoiVW5pc3dhcCAtIDAuMyUgLSBEQUkvV0VUSCAtIDgwNC4wNTw+NDAxNC4yIiwgImRlc2NyaXB0aW9uIjoiVGhpcyBORlQgcmVwcmVzZW50cyBhIGxpcXVpZGl0eSBwb3NpdGlvbiBpbiBhIFVuaXN3YXAgVjMgREFJLVdFVEggcG9vbC4gVGhlIG93bmVyIG9mIHRoaXMgTkZUIGNhbiBtb2RpZnkgb3IgcmVkZWVtIHRoZSBwb3NpdGlvbi5cblxuUG9vbCBBZGRyZXNzOiAweGMyZTlmMjViZTYyNTdjMjEwZDdhZGYwZDRjZDZlM2U4ODFiYTI1ZjhcbkRBSSBBZGRyZXNzOiAweDZiMTc1NDc0ZTg5MDk0YzQ0ZGE5OGI5NTRlZWRlYWM0OTUyNzFkMGZcbldFVEggQWRkcmVzczogMHhjMDJhYWEzOWIyMjNmZThkMGEwZTVjNGYyN2VhZDkwODNjNzU2Y2MyXG5GZWUgVGllcjogMC4zJVxuVG9rZW4gSUQ6IDUxMjc5M1xuXG7imqDvuI8gRElTQ0xBSU1FUjogRHVlIGRpbGlnZW5jZSBpcyBpbXBlcmF0aXZlIHdoZW4gYXNzZXNzaW5nIHRoaXMgTkZULiBNYWtlIHN1cmUgdG9rZW4gYWRkcmVzc2VzIG1hdGNoIHRoZSBleHBlY3RlZCB0b2tlbnMsIGFzIHRva2VuIHN5bWJvbHMgbWF5IGJlIGltaXRhdGVkLiIsICJpbWFnZSI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUIzYVdSMGFEMGlNamt3SWlCb1pXbG5hSFE5SWpVd01DSWdkbWxsZDBKdmVEMGlNQ0F3SURJNU1DQTFNREFpSUhodGJHNXpQU0pvZEhSd09pOHZkM2QzTG5jekxtOXlaeTh5TURBd0wzTjJaeUlnZUcxc2JuTTZlR3hwYm1zOUoyaDBkSEE2THk5M2QzY3Vkek11YjNKbkx6RTVPVGt2ZUd4cGJtc25QanhrWldaelBqeG1hV3gwWlhJZ2FXUTlJbVl4SWo0OFptVkpiV0ZuWlNCeVpYTjFiSFE5SW5Bd0lpQjRiR2x1YXpwb2NtVm1QU0prWVhSaE9tbHRZV2RsTDNOMlp5dDRiV3c3WW1GelpUWTBMRkJJVGpKYWVVSXpZVmRTTUdGRU1HNU5hbXQzU25sQ2IxcFhiRzVoU0ZFNVNucFZkMDFEWTJka2JXeHNaREJLZG1WRU1HNU5RMEYzU1VSSk5VMURRVEZOUkVGdVNVaG9kR0pITlhwUVUyUnZaRWhTZDA5cE9IWmtNMlF6VEc1amVreHRPWGxhZVRoNVRVUkJkMHd6VGpKYWVXTXJVRWhLYkZrelVXZGtNbXhyWkVkbk9VcDZTVFZOU0VJMFNubENiMXBYYkc1aFNGRTVTbnBWZDAxSVFqUktlVUp0WVZkNGMxQlRZMnBPYlVsNFRucFZNRXA1T0N0UVF6bDZaRzFqS3lJdlBqeG1aVWx0WVdkbElISmxjM1ZzZEQwaWNERWlJSGhzYVc1ck9taHlaV1k5SW1SaGRHRTZhVzFoWjJVdmMzWm5LM2h0YkR0aVlYTmxOalFzVUVoT01scDVRak5oVjFJd1lVUXdiazFxYTNkS2VVSnZXbGRzYm1GSVVUbEtlbFYzVFVOaloyUnRiR3hrTUVwMlpVUXdiazFEUVhkSlJFazFUVU5CTVUxRVFXNUpTR2gwWWtjMWVsQlRaRzlrU0ZKM1QyazRkbVF6WkROTWJtTjZURzA1ZVZwNU9IbE5SRUYzVEROT01scDVZeXRRUjA1d1kyMU9jMXBUUW1wbFJEQnVUbFJuYmtsSFRqVlFVMk41VDBScmJrbElTVGxLZWtWNVRVaENORXA1UW0xaFYzaHpVRk5qYWxsNlFYbFpWMFpvU25rNEsxQkRPWHBrYldNcklpOCtQR1psU1cxaFoyVWdjbVZ6ZFd4MFBTSndNaUlnZUd4cGJtczZhSEpsWmowaVpHRjBZVHBwYldGblpTOXpkbWNyZUcxc08ySmhjMlUyTkN4UVNFNHlXbmxDTTJGWFVqQmhSREJ1VFdwcmQwcDVRbTlhVjJ4dVlVaFJPVXA2VlhkTlEyTm5aRzFzYkdRd1NuWmxSREJ1VFVOQmQwbEVTVFZOUTBFeFRVUkJia2xJYUhSaVJ6VjZVRk5rYjJSSVVuZFBhVGgyWkROa00weHVZM3BNYlRsNVduazRlVTFFUVhkTU0wNHlXbmxqSzFCSFRuQmpiVTV6V2xOQ2FtVkVNRzVOYWtVeVNubENhbVZVTUc1TmVrMDFTbmxDZVZCVFkzaE5ha0ozWlVOaloxcHRiSE5pUkRCdVNYcEpNMDFYVVhkYWFXTjJVR3AzZG1NeldtNVFaejA5SWlBdlBqeG1aVWx0WVdkbElISmxjM1ZzZEQwaWNETWlJSGhzYVc1ck9taHlaV1k5SW1SaGRHRTZhVzFoWjJVdmMzWm5LM2h0YkR0aVlYTmxOalFzVUVoT01scDVRak5oVjFJd1lVUXdiazFxYTNkS2VVSnZXbGRzYm1GSVVUbEtlbFYzVFVOaloyUnRiR3hrTUVwMlpVUXdiazFEUVhkSlJFazFUVU5CTVUxRVFXNUpTR2gwWWtjMWVsQlRaRzlrU0ZKM1QyazRkbVF6WkROTWJtTjZURzA1ZVZwNU9IbE5SRUYzVEROT01scDVZeXRRUjA1d1kyMU9jMXBUUW1wbFJEQnVUV3BOTUVwNVFtcGxWREJ1VGtSak5VcDVRbmxRVTJONFRVUkNkMlZEWTJkYWJXeHpZa1F3YmtsNll6Rk9iVTVxVFdsamRsQnFkM1pqTTFwdVVHYzlQU0lnTHo0OFptVkNiR1Z1WkNCdGIyUmxQU0p2ZG1WeWJHRjVJaUJwYmowaWNEQWlJR2x1TWowaWNERWlJQzgrUEdabFFteGxibVFnYlc5a1pUMGlaWGhqYkhWemFXOXVJaUJwYmpJOUluQXlJaUF2UGp4bVpVSnNaVzVrSUcxdlpHVTlJbTkyWlhKc1lYa2lJR2x1TWowaWNETWlJSEpsYzNWc2REMGlZbXhsYm1SUGRYUWlJQzgrUEdabFIyRjFjM05wWVc1Q2JIVnlJR2x1UFNKaWJHVnVaRTkxZENJZ2MzUmtSR1YyYVdGMGFXOXVQU0kwTWlJZ0x6NDhMMlpwYkhSbGNqNGdQR05zYVhCUVlYUm9JR2xrUFNKamIzSnVaWEp6SWo0OGNtVmpkQ0IzYVdSMGFEMGlNamt3SWlCb1pXbG5hSFE5SWpVd01DSWdjbmc5SWpReUlpQnllVDBpTkRJaUlDOCtQQzlqYkdsd1VHRjBhRDQ4Y0dGMGFDQnBaRDBpZEdWNGRDMXdZWFJvTFdFaUlHUTlJazAwTUNBeE1pQklNalV3SUVFeU9DQXlPQ0F3SURBZ01TQXlOemdnTkRBZ1ZqUTJNQ0JCTWpnZ01qZ2dNQ0F3SURFZ01qVXdJRFE0T0NCSU5EQWdRVEk0SURJNElEQWdNQ0F4SURFeUlEUTJNQ0JXTkRBZ1FUSTRJREk0SURBZ01DQXhJRFF3SURFeUlIb2lJQzgrUEhCaGRHZ2dhV1E5SW0xcGJtbHRZWEFpSUdROUlrMHlNelFnTkRRMFF6SXpOQ0EwTlRjdU9UUTVJREkwTWk0eU1TQTBOak1nTWpVeklEUTJNeUlnTHo0OFptbHNkR1Z5SUdsa1BTSjBiM0F0Y21WbmFXOXVMV0pzZFhJaVBqeG1aVWRoZFhOemFXRnVRbXgxY2lCcGJqMGlVMjkxY21ObFIzSmhjR2hwWXlJZ2MzUmtSR1YyYVdGMGFXOXVQU0l5TkNJZ0x6NDhMMlpwYkhSbGNqNDhiR2x1WldGeVIzSmhaR2xsYm5RZ2FXUTlJbWR5WVdRdGRYQWlJSGd4UFNJeElpQjRNajBpTUNJZ2VURTlJakVpSUhreVBTSXdJajQ4YzNSdmNDQnZabVp6WlhROUlqQXVNQ0lnYzNSdmNDMWpiMnh2Y2owaWQyaHBkR1VpSUhOMGIzQXRiM0JoWTJsMGVUMGlNU0lnTHo0OGMzUnZjQ0J2Wm1aelpYUTlJaTQ1SWlCemRHOXdMV052Ykc5eVBTSjNhR2wwWlNJZ2MzUnZjQzF2Y0dGamFYUjVQU0l3SWlBdlBqd3ZiR2x1WldGeVIzSmhaR2xsYm5RK1BHeHBibVZoY2tkeVlXUnBaVzUwSUdsa1BTSm5jbUZrTFdSdmQyNGlJSGd4UFNJd0lpQjRNajBpTVNJZ2VURTlJakFpSUhreVBTSXhJajQ4YzNSdmNDQnZabVp6WlhROUlqQXVNQ0lnYzNSdmNDMWpiMnh2Y2owaWQyaHBkR1VpSUhOMGIzQXRiM0JoWTJsMGVUMGlNU0lnTHo0OGMzUnZjQ0J2Wm1aelpYUTlJakF1T1NJZ2MzUnZjQzFqYjJ4dmNqMGlkMmhwZEdVaUlITjBiM0F0YjNCaFkybDBlVDBpTUNJZ0x6NDhMMnhwYm1WaGNrZHlZV1JwWlc1MFBqeHRZWE5ySUdsa1BTSm1ZV1JsTFhWd0lpQnRZWE5yUTI5dWRHVnVkRlZ1YVhSelBTSnZZbXBsWTNSQ2IzVnVaR2x1WjBKdmVDSStQSEpsWTNRZ2QybGtkR2c5SWpFaUlHaGxhV2RvZEQwaU1TSWdabWxzYkQwaWRYSnNLQ05uY21Ga0xYVndLU0lnTHo0OEwyMWhjMnMrUEcxaGMyc2dhV1E5SW1aaFpHVXRaRzkzYmlJZ2JXRnphME52Ym5SbGJuUlZibWwwY3owaWIySnFaV04wUW05MWJtUnBibWRDYjNnaVBqeHlaV04wSUhkcFpIUm9QU0l4SWlCb1pXbG5hSFE5SWpFaUlHWnBiR3c5SW5WeWJDZ2paM0poWkMxa2IzZHVLU0lnTHo0OEwyMWhjMnMrUEcxaGMyc2dhV1E5SW01dmJtVWlJRzFoYzJ0RGIyNTBaVzUwVlc1cGRITTlJbTlpYW1WamRFSnZkVzVrYVc1blFtOTRJajQ4Y21WamRDQjNhV1IwYUQwaU1TSWdhR1ZwWjJoMFBTSXhJaUJtYVd4c1BTSjNhR2wwWlNJZ0x6NDhMMjFoYzJzK1BHeHBibVZoY2tkeVlXUnBaVzUwSUdsa1BTSm5jbUZrTFhONWJXSnZiQ0krUEhOMGIzQWdiMlptYzJWMFBTSXdMamNpSUhOMGIzQXRZMjlzYjNJOUluZG9hWFJsSWlCemRHOXdMVzl3WVdOcGRIazlJakVpSUM4K1BITjBiM0FnYjJabWMyVjBQU0l1T1RVaUlITjBiM0F0WTI5c2IzSTlJbmRvYVhSbElpQnpkRzl3TFc5d1lXTnBkSGs5SWpBaUlDOCtQQzlzYVc1bFlYSkhjbUZrYVdWdWRENDhiV0Z6YXlCcFpEMGlabUZrWlMxemVXMWliMndpSUcxaGMydERiMjUwWlc1MFZXNXBkSE05SW5WelpYSlRjR0ZqWlU5dVZYTmxJajQ4Y21WamRDQjNhV1IwYUQwaU1qa3djSGdpSUdobGFXZG9kRDBpTWpBd2NIZ2lJR1pwYkd3OUluVnliQ2dqWjNKaFpDMXplVzFpYjJ3cElpQXZQand2YldGemF6NDhMMlJsWm5NK1BHY2dZMnhwY0Mxd1lYUm9QU0oxY213b0kyTnZjbTVsY25NcElqNDhjbVZqZENCbWFXeHNQU0kyWWpFM05UUWlJSGc5SWpCd2VDSWdlVDBpTUhCNElpQjNhV1IwYUQwaU1qa3djSGdpSUdobGFXZG9kRDBpTlRBd2NIZ2lJQzgrUEhKbFkzUWdjM1I1YkdVOUltWnBiSFJsY2pvZ2RYSnNLQ05tTVNraUlIZzlJakJ3ZUNJZ2VUMGlNSEI0SWlCM2FXUjBhRDBpTWprd2NIZ2lJR2hsYVdkb2REMGlOVEF3Y0hnaUlDOCtJRHhuSUhOMGVXeGxQU0ptYVd4MFpYSTZkWEpzS0NOMGIzQXRjbVZuYVc5dUxXSnNkWElwT3lCMGNtRnVjMlp2Y20wNmMyTmhiR1VvTVM0MUtUc2dkSEpoYm5ObWIzSnRMVzl5YVdkcGJqcGpaVzUwWlhJZ2RHOXdPeUkrUEhKbFkzUWdabWxzYkQwaWJtOXVaU0lnZUQwaU1IQjRJaUI1UFNJd2NIZ2lJSGRwWkhSb1BTSXlPVEJ3ZUNJZ2FHVnBaMmgwUFNJMU1EQndlQ0lnTHo0OFpXeHNhWEJ6WlNCamVEMGlOVEFsSWlCamVUMGlNSEI0SWlCeWVEMGlNVGd3Y0hnaUlISjVQU0l4TWpCd2VDSWdabWxzYkQwaUl6QXdNQ0lnYjNCaFkybDBlVDBpTUM0NE5TSWdMejQ4TDJjK1BISmxZM1FnZUQwaU1DSWdlVDBpTUNJZ2QybGtkR2c5SWpJNU1DSWdhR1ZwWjJoMFBTSTFNREFpSUhKNFBTSTBNaUlnY25rOUlqUXlJaUJtYVd4c1BTSnlaMkpoS0RBc01Dd3dMREFwSWlCemRISnZhMlU5SW5KblltRW9NalUxTERJMU5Td3lOVFVzTUM0eUtTSWdMejQ4TDJjK1BIUmxlSFFnZEdWNGRDMXlaVzVrWlhKcGJtYzlJbTl3ZEdsdGFYcGxVM0JsWldRaVBqeDBaWGgwVUdGMGFDQnpkR0Z5ZEU5bVpuTmxkRDBpTFRFd01DVWlJR1pwYkd3OUluZG9hWFJsSWlCbWIyNTBMV1poYldsc2VUMGlKME52ZFhKcFpYSWdUbVYzSnl3Z2JXOXViM053WVdObElpQm1iMjUwTFhOcGVtVTlJakV3Y0hnaUlIaHNhVzVyT21oeVpXWTlJaU4wWlhoMExYQmhkR2d0WVNJK01IaGpNREpoWVdFek9XSXlNak5tWlRoa01HRXdaVFZqTkdZeU4yVmhaRGt3T0ROak56VTJZMk15SU9LQW9pQlhSVlJJSUR4aGJtbHRZWFJsSUdGa1pHbDBhWFpsUFNKemRXMGlJR0YwZEhKcFluVjBaVTVoYldVOUluTjBZWEowVDJabWMyVjBJaUJtY205dFBTSXdKU0lnZEc4OUlqRXdNQ1VpSUdKbFoybHVQU0l3Y3lJZ1pIVnlQU0l6TUhNaUlISmxjR1ZoZEVOdmRXNTBQU0pwYm1SbFptbHVhWFJsSWlBdlBqd3ZkR1Y0ZEZCaGRHZytJRHgwWlhoMFVHRjBhQ0J6ZEdGeWRFOW1abk5sZEQwaU1DVWlJR1pwYkd3OUluZG9hWFJsSWlCbWIyNTBMV1poYldsc2VUMGlKME52ZFhKcFpYSWdUbVYzSnl3Z2JXOXViM053WVdObElpQm1iMjUwTFhOcGVtVTlJakV3Y0hnaUlIaHNhVzVyT21oeVpXWTlJaU4wWlhoMExYQmhkR2d0WVNJK01IaGpNREpoWVdFek9XSXlNak5tWlRoa01HRXdaVFZqTkdZeU4yVmhaRGt3T0ROak56VTJZMk15SU9LQW9pQlhSVlJJSUR4aGJtbHRZWFJsSUdGa1pHbDBhWFpsUFNKemRXMGlJR0YwZEhKcFluVjBaVTVoYldVOUluTjBZWEowVDJabWMyVjBJaUJtY205dFBTSXdKU0lnZEc4OUlqRXdNQ1VpSUdKbFoybHVQU0l3Y3lJZ1pIVnlQU0l6TUhNaUlISmxjR1ZoZEVOdmRXNTBQU0pwYm1SbFptbHVhWFJsSWlBdlBpQThMM1JsZUhSUVlYUm9QangwWlhoMFVHRjBhQ0J6ZEdGeWRFOW1abk5sZEQwaU5UQWxJaUJtYVd4c1BTSjNhR2wwWlNJZ1ptOXVkQzFtWVcxcGJIazlJaWREYjNWeWFXVnlJRTVsZHljc0lHMXZibTl6Y0dGalpTSWdabTl1ZEMxemFYcGxQU0l4TUhCNElpQjRiR2x1YXpwb2NtVm1QU0lqZEdWNGRDMXdZWFJvTFdFaVBqQjRObUl4TnpVME56UmxPRGt3T1RSak5EUmtZVGs0WWprMU5HVmxaR1ZoWXpRNU5USTNNV1F3WmlEaWdLSWdSRUZKSUR4aGJtbHRZWFJsSUdGa1pHbDBhWFpsUFNKemRXMGlJR0YwZEhKcFluVjBaVTVoYldVOUluTjBZWEowVDJabWMyVjBJaUJtY205dFBTSXdKU0lnZEc4OUlqRXdNQ1VpSUdKbFoybHVQU0l3Y3lJZ1pIVnlQU0l6TUhNaUlISmxjR1ZoZEVOdmRXNTBQU0pwYm1SbFptbHVhWFJsSWlBdlBqd3ZkR1Y0ZEZCaGRHZytQSFJsZUhSUVlYUm9JSE4wWVhKMFQyWm1jMlYwUFNJdE5UQWxJaUJtYVd4c1BTSjNhR2wwWlNJZ1ptOXVkQzFtWVcxcGJIazlJaWREYjNWeWFXVnlJRTVsZHljc0lHMXZibTl6Y0dGalpTSWdabTl1ZEMxemFYcGxQU0l4TUhCNElpQjRiR2x1YXpwb2NtVm1QU0lqZEdWNGRDMXdZWFJvTFdFaVBqQjRObUl4TnpVME56UmxPRGt3T1RSak5EUmtZVGs0WWprMU5HVmxaR1ZoWXpRNU5USTNNV1F3WmlEaWdLSWdSRUZKSUR4aGJtbHRZWFJsSUdGa1pHbDBhWFpsUFNKemRXMGlJR0YwZEhKcFluVjBaVTVoYldVOUluTjBZWEowVDJabWMyVjBJaUJtY205dFBTSXdKU0lnZEc4OUlqRXdNQ1VpSUdKbFoybHVQU0l3Y3lJZ1pIVnlQU0l6TUhNaUlISmxjR1ZoZEVOdmRXNTBQU0pwYm1SbFptbHVhWFJsSWlBdlBqd3ZkR1Y0ZEZCaGRHZytQQzkwWlhoMFBqeG5JRzFoYzJzOUluVnliQ2dqWm1Ga1pTMXplVzFpYjJ3cElqNDhjbVZqZENCbWFXeHNQU0p1YjI1bElpQjRQU0l3Y0hnaUlIazlJakJ3ZUNJZ2QybGtkR2c5SWpJNU1IQjRJaUJvWldsbmFIUTlJakl3TUhCNElpQXZQaUE4ZEdWNGRDQjVQU0kzTUhCNElpQjRQU0l6TW5CNElpQm1hV3hzUFNKM2FHbDBaU0lnWm05dWRDMW1ZVzFwYkhrOUlpZERiM1Z5YVdWeUlFNWxkeWNzSUcxdmJtOXpjR0ZqWlNJZ1ptOXVkQzEzWldsbmFIUTlJakl3TUNJZ1ptOXVkQzF6YVhwbFBTSXpObkI0SWo1RVFVa3ZWMFZVU0R3dmRHVjRkRDQ4ZEdWNGRDQjVQU0l4TVRWd2VDSWdlRDBpTXpKd2VDSWdabWxzYkQwaWQyaHBkR1VpSUdadmJuUXRabUZ0YVd4NVBTSW5RMjkxY21sbGNpQk9aWGNuTENCdGIyNXZjM0JoWTJVaUlHWnZiblF0ZDJWcFoyaDBQU0l5TURBaUlHWnZiblF0YzJsNlpUMGlNelp3ZUNJK01DNHpKVHd2ZEdWNGRENDhMMmMrUEhKbFkzUWdlRDBpTVRZaUlIazlJakUySWlCM2FXUjBhRDBpTWpVNElpQm9aV2xuYUhROUlqUTJPQ0lnY25nOUlqSTJJaUJ5ZVQwaU1qWWlJR1pwYkd3OUluSm5ZbUVvTUN3d0xEQXNNQ2tpSUhOMGNtOXJaVDBpY21kaVlTZ3lOVFVzTWpVMUxESTFOU3d3TGpJcElpQXZQanhuSUcxaGMyczlJblZ5YkNnamJtOXVaU2tpSUhOMGVXeGxQU0owY21GdWMyWnZjbTA2ZEhKaGJuTnNZWFJsS0RjeWNIZ3NNVGc1Y0hncElqNDhjbVZqZENCNFBTSXRNVFp3ZUNJZ2VUMGlMVEUyY0hnaUlIZHBaSFJvUFNJeE9EQndlQ0lnYUdWcFoyaDBQU0l4T0RCd2VDSWdabWxzYkQwaWJtOXVaU0lnTHo0OGNHRjBhQ0JrUFNKTk1TQXhRekVnT1RjZ05Ea2dNVFExSURFME5TQXhORFVpSUhOMGNtOXJaVDBpY21kaVlTZ3dMREFzTUN3d0xqTXBJaUJ6ZEhKdmEyVXRkMmxrZEdnOUlqTXljSGdpSUdacGJHdzlJbTV2Ym1VaUlITjBjbTlyWlMxc2FXNWxZMkZ3UFNKeWIzVnVaQ0lnTHo0OEwyYytQR2NnYldGemF6MGlkWEpzS0NOdWIyNWxLU0lnYzNSNWJHVTlJblJ5WVc1elptOXliVHAwY21GdWMyeGhkR1VvTnpKd2VDd3hPRGx3ZUNraVBqeHlaV04wSUhnOUlpMHhObkI0SWlCNVBTSXRNVFp3ZUNJZ2QybGtkR2c5SWpFNE1IQjRJaUJvWldsbmFIUTlJakU0TUhCNElpQm1hV3hzUFNKdWIyNWxJaUF2UGp4d1lYUm9JR1E5SWsweElERkRNU0E1TnlBME9TQXhORFVnTVRRMUlERTBOU0lnYzNSeWIydGxQU0p5WjJKaEtESTFOU3d5TlRVc01qVTFMREVwSWlCbWFXeHNQU0p1YjI1bElpQnpkSEp2YTJVdGJHbHVaV05oY0QwaWNtOTFibVFpSUM4K1BDOW5QanhqYVhKamJHVWdZM2c5SWpjemNIZ2lJR041UFNJeE9UQndlQ0lnY2owaU5IQjRJaUJtYVd4c1BTSjNhR2wwWlNJZ0x6NDhZMmx5WTJ4bElHTjRQU0l5TVRkd2VDSWdZM2s5SWpNek5IQjRJaUJ5UFNJMGNIZ2lJR1pwYkd3OUluZG9hWFJsSWlBdlBpQThaeUJ6ZEhsc1pUMGlkSEpoYm5ObWIzSnRPblJ5WVc1emJHRjBaU2d5T1hCNExDQXpPRFJ3ZUNraVBqeHlaV04wSUhkcFpIUm9QU0k1T0hCNElpQm9aV2xuYUhROUlqSTJjSGdpSUhKNFBTSTRjSGdpSUhKNVBTSTRjSGdpSUdacGJHdzlJbkpuWW1Fb01Dd3dMREFzTUM0MktTSWdMejQ4ZEdWNGRDQjRQU0l4TW5CNElpQjVQU0l4TjNCNElpQm1iMjUwTFdaaGJXbHNlVDBpSjBOdmRYSnBaWElnVG1WM0p5d2diVzl1YjNOd1lXTmxJaUJtYjI1MExYTnBlbVU5SWpFeWNIZ2lJR1pwYkd3OUluZG9hWFJsSWo0OGRITndZVzRnWm1sc2JEMGljbWRpWVNneU5UVXNNalUxTERJMU5Td3dMallwSWo1SlJEb2dQQzkwYzNCaGJqNDFNVEkzT1RNOEwzUmxlSFErUEM5blBpQThaeUJ6ZEhsc1pUMGlkSEpoYm5ObWIzSnRPblJ5WVc1emJHRjBaU2d5T1hCNExDQTBNVFJ3ZUNraVBqeHlaV04wSUhkcFpIUm9QU0l4TkRCd2VDSWdhR1ZwWjJoMFBTSXlObkI0SWlCeWVEMGlPSEI0SWlCeWVUMGlPSEI0SWlCbWFXeHNQU0p5WjJKaEtEQXNNQ3d3TERBdU5pa2lJQzgrUEhSbGVIUWdlRDBpTVRKd2VDSWdlVDBpTVRkd2VDSWdabTl1ZEMxbVlXMXBiSGs5SWlkRGIzVnlhV1Z5SUU1bGR5Y3NJRzF2Ym05emNHRmpaU0lnWm05dWRDMXphWHBsUFNJeE1uQjRJaUJtYVd4c1BTSjNhR2wwWlNJK1BIUnpjR0Z1SUdacGJHdzlJbkpuWW1Fb01qVTFMREkxTlN3eU5UVXNNQzQyS1NJK1RXbHVJRlJwWTJzNklEd3ZkSE53WVc0K0xUZ3lPVGd3UEM5MFpYaDBQand2Wno0Z1BHY2djM1I1YkdVOUluUnlZVzV6Wm05eWJUcDBjbUZ1YzJ4aGRHVW9Namx3ZUN3Z05EUTBjSGdwSWo0OGNtVmpkQ0IzYVdSMGFEMGlNVFF3Y0hnaUlHaGxhV2RvZEQwaU1qWndlQ0lnY25nOUlqaHdlQ0lnY25rOUlqaHdlQ0lnWm1sc2JEMGljbWRpWVNnd0xEQXNNQ3d3TGpZcElpQXZQangwWlhoMElIZzlJakV5Y0hnaUlIazlJakUzY0hnaUlHWnZiblF0Wm1GdGFXeDVQU0luUTI5MWNtbGxjaUJPWlhjbkxDQnRiMjV2YzNCaFkyVWlJR1p2Ym5RdGMybDZaVDBpTVRKd2VDSWdabWxzYkQwaWQyaHBkR1VpUGp4MGMzQmhiaUJtYVd4c1BTSnlaMkpoS0RJMU5Td3lOVFVzTWpVMUxEQXVOaWtpUGsxaGVDQlVhV05yT2lBOEwzUnpjR0Z1UGkwMk5qa3dNRHd2ZEdWNGRENDhMMmMrUEdjZ2MzUjViR1U5SW5SeVlXNXpabTl5YlRwMGNtRnVjMnhoZEdVb01qSTJjSGdzSURRek0zQjRLU0krUEhKbFkzUWdkMmxrZEdnOUlqTTJjSGdpSUdobGFXZG9kRDBpTXpad2VDSWdjbmc5SWpod2VDSWdjbms5SWpod2VDSWdabWxzYkQwaWJtOXVaU0lnYzNSeWIydGxQU0p5WjJKaEtESTFOU3d5TlRVc01qVTFMREF1TWlraUlDOCtQSEJoZEdnZ2MzUnliMnRsTFd4cGJtVmpZWEE5SW5KdmRXNWtJaUJrUFNKTk9DQTVRemd1TURBd01EUWdNakl1T1RRNU5DQXhOaTR5TURrNUlESTRJREkzSURJNElpQm1hV3hzUFNKdWIyNWxJaUJ6ZEhKdmEyVTlJbmRvYVhSbElpQXZQanhqYVhKamJHVWdjM1I1YkdVOUluUnlZVzV6Wm05eWJUcDBjbUZ1YzJ4aGRHVXpaQ2c0Y0hnc0lERXdMalZ3ZUN3Z01IQjRLU0lnWTNnOUlqQndlQ0lnWTNrOUlqQndlQ0lnY2owaU5IQjRJaUJtYVd4c1BTSjNhR2wwWlNJdlBqd3ZaejQ4TDNOMlp6ND0ifQ==",
						},
					},
					{
						Type:     filter.TypeExchangeLiquidity,
						Platform: filter.PlatformUniswap.String(),
						From:     "0xf69A8916669De197E84Cb39A38bA5115e8efCC77",
						To:       uniswap.AddressNonfungiblePositionManager.String(),
						Metadata: metadata.ExchangeLiquidity{
							Action: metadata.ActionExchangeLiquidityAdd,
							Tokens: []metadata.Token{
								{
									Address:  lo.ToPtr("0x6B175474E89094C44Da98b954EedeAC495271d0F"),
									Value:    lo.ToPtr(lo.Must(decimal.NewFromString("15026142111118622550571"))),
									Name:     "Dai Stablecoin",
									Symbol:   "DAI",
									Decimals: 18,
									Standard: metadata.StandardERC20,
								},
								{
									Address:  lo.ToPtr("0xC02aaA39b223FE8D0A0e5C4F27eAD9083C756Cc2"),
									Value:    lo.ToPtr(lo.Must(decimal.NewFromString("8296019405933437439"))),
									Name:     "Wrapped Ether",
									Symbol:   "WETH",
									Decimals: 18,
									Standard: metadata.StandardERC20,
								},
							},
						},
					},
				},
				Status:    true,
				Timestamp: 1685020067,
			},
			wantError: require.NoError,
		},
		{
			name: "Swap Token on V3 Router",
			arguments: arguments{
				task: &source.Task{
					Network: filter.NetworkRSS3Testnet,
					ChainID: 2331,
					Header: &ethereum.Header{
						Hash:         common.HexToHash("0xb77f24fb839b0de959f27180575c034cedaaf88156b5027fd70ddb8cd3fe7f4d"),
						ParentHash:   common.HexToHash("0x696063b438e6e374cd8ae3ce1e7aef28f430ef840cd937ae911c5bcdcefc61c8"),
						UncleHash:    common.HexToHash("0x1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347"),
						Coinbase:     common.HexToAddress("0x4200000000000000000000000000000000000011"),
						Number:       lo.Must(new(big.Int).SetString("66663", 0)),
						GasLimit:     30000000,
						GasUsed:      185665,
						Timestamp:    1708793646,
						BaseFee:      lo.Must(new(big.Int).SetString("50", 0)),
						Transactions: nil,
					},
					Transaction: &ethereum.Transaction{
						BlockHash: common.HexToHash("0xadbe6bce79d27659e22d9ccc730361a20b234a9df0e753a747ff6e33636e6844"),
						From:      common.HexToAddress("0xeB7E951F2D1A38188762dF12E0703aE16F76Ab73"),
						Gas:       124840,
						GasPrice:  lo.Must(new(big.Int).SetString("1000050", 10)),
						Hash:      common.HexToHash("0xadbe6bce79d27659e22d9ccc730361a20b234a9df0e753a747ff6e33636e6844"),
						Input:     hexutil.MustDecode("0x414bf38900000000000000000000000005bf18310a20fbaeba376282b5fc6cc0a404402b00000000000000000000000045356c3721e479492d03c4d956aaed17e8ca9bce0000000000000000000000000000000000000000000000000000000000000bb8000000000000000000000000eb7e951f2d1a38188762df12e0703ae16f76ab7300000000000000000000000000000000000000000000000000000000a170511b000000000000000000000000000000000000000000000000000000000007a12000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000"),
						To:        lo.ToPtr(common.HexToAddress("0xe8A7aAbb64B446505c7722c4347C6Cc67E0A9a8d")),
						Value:     lo.Must(new(big.Int).SetString("0", 0)),
						Type:      2,
						ChainID:   lo.Must(new(big.Int).SetString("2331", 0)),
					},
					Receipt: &ethereum.Receipt{
						BlockHash:         common.HexToHash("0xb77f24fb839b0de959f27180575c034cedaaf88156b5027fd70ddb8cd3fe7f4d"),
						BlockNumber:       lo.Must(new(big.Int).SetString("66663", 0)),
						ContractAddress:   nil,
						CumulativeGasUsed: 185665,
						EffectiveGasPrice: hexutil.MustDecodeBig("0xf4272"),
						GasUsed:           121640,
						L1GasPrice:        lo.Must(new(big.Int).SetString("33092243873", 0)),
						L1GasUsed:         lo.Must(new(big.Int).SetString("5824", 0)),
						L1Fee:             lo.Must(new(big.Int).SetString("2890938424745280000", 0)),
						FeeScalar:         lo.Must(new(big.Float).SetString("15000")),
						Logs: []*ethereum.Log{{
							Address: common.HexToAddress("0x45356c3721E479492D03c4d956AaEd17e8CA9BCe"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x000000000000000000000000949203e07a0bed0242dfcc7ee6c0007ba967f667"),
								common.HexToHash("0x000000000000000000000000eb7e951f2d1a38188762df12e0703ae16f76ab73"),
							},
							Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000000000000000159527cf"),
							BlockNumber:     lo.Must(new(big.Int).SetString("66663", 0)),
							TransactionHash: common.HexToHash("0xadbe6bce79d27659e22d9ccc730361a20b234a9df0e753a747ff6e33636e6844"),
							Index:           0,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x05BF18310a20FBAeBA376282B5FC6CC0A404402B"),
							Topics: []common.Hash{
								common.HexToHash("0x8c5be1e5ebec7d5bd14f71427d1e84f3dd0314c0f7b2291e5b200ac8c7c3b925"),
								common.HexToHash("0x000000000000000000000000eb7e951f2d1a38188762df12e0703ae16f76ab73"),
								common.HexToHash("0x000000000000000000000000e8a7aabb64b446505c7722c4347c6cc67e0a9a8d"),
							},
							Data:            hexutil.MustDecode("0x00000000000000000000000000000000000000000000021e19e0c9bab2385ee0"),
							BlockNumber:     lo.Must(new(big.Int).SetString("66663", 0)),
							TransactionHash: common.HexToHash("0xadbe6bce79d27659e22d9ccc730361a20b234a9df0e753a747ff6e33636e6844"),
							Index:           1,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x05BF18310a20FBAeBA376282B5FC6CC0A404402B"),
							Topics: []common.Hash{
								common.HexToHash("0xddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef"),
								common.HexToHash("0x000000000000000000000000eb7e951f2d1a38188762df12e0703ae16f76ab73"),
								common.HexToHash("0x000000000000000000000000949203e07a0bed0242dfcc7ee6c0007ba967f667"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000000000000007a120"),
							BlockNumber:     lo.Must(new(big.Int).SetString("66663", 0)),
							TransactionHash: common.HexToHash("0xadbe6bce79d27659e22d9ccc730361a20b234a9df0e753a747ff6e33636e6844"),
							Index:           2,
							Removed:         false,
						}, {
							Address: common.HexToAddress("0x949203e07a0bEd0242dfcc7eE6c0007bA967f667"),
							Topics: []common.Hash{
								common.HexToHash("0xc42079f94a6350d7e6235f29174924f928cc2ac818eb64fed8004e115fbcca67"),
								common.HexToHash("0x000000000000000000000000e8a7aabb64b446505c7722c4347c6cc67e0a9a8d"),
								common.HexToHash("0x000000000000000000000000eb7e951f2d1a38188762df12e0703ae16f76ab73"),
							},
							Data:            hexutil.MustDecode("0x000000000000000000000000000000000000000000000000000000000007a120ffffffffffffffffffffffffffffffffffffffffffffffffffffffffea6ad831000000000000000000000000000000000000001af38810b08c8142473c618e32000000000000000000000000000000000000000000000000337dfa4818d01399000000000000000000000000000000000000000000000000000000000001015b"),
							BlockNumber:     lo.Must(new(big.Int).SetString("66663", 0)),
							TransactionHash: common.HexToHash("0xadbe6bce79d27659e22d9ccc730361a20b234a9df0e753a747ff6e33636e6844"),
							Index:           3,
							Removed:         false,
						}},
						Status:           1,
						TransactionHash:  common.HexToHash("0xadbe6bce79d27659e22d9ccc730361a20b234a9df0e753a747ff6e33636e6844"),
						TransactionIndex: 1,
					},
				},
				config: &config.Module{
					Network:  filter.NetworkRSS3Testnet,
					Endpoint: endpoint.MustGet(filter.NetworkRSS3Testnet),
				},
			},
			want: &schema.Feed{
				ID:      "0xadbe6bce79d27659e22d9ccc730361a20b234a9df0e753a747ff6e33636e6844",
				Network: filter.NetworkRSS3Testnet,
				Index:   1,
				From:    "0xeB7E951F2D1A38188762dF12E0703aE16F76Ab73",
				To:      uniswap.AddressV3SwapRouterRSS3Testnet.String(),
				Type:    filter.TypeExchangeSwap,
				Calldata: &schema.Calldata{
					FunctionHash: "0x414bf389",
				},
				Platform: lo.ToPtr(filter.PlatformUniswap),
				Fee: &schema.Fee{
					Amount:  lo.Must(decimal.NewFromString("2890938546391362000")),
					Decimal: 18,
				},
				Actions: []*schema.Action{
					{
						Type:     filter.TypeExchangeSwap,
						Platform: filter.PlatformUniswap.String(),
						From:     "0xeB7E951F2D1A38188762dF12E0703aE16F76Ab73",
						To:       "0xeB7E951F2D1A38188762dF12E0703aE16F76Ab73",
						Metadata: metadata.ExchangeSwap{
							From: metadata.Token{
								Address:  lo.ToPtr("0x05BF18310a20FBAeBA376282B5FC6CC0A404402B"),
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("500000"))),
								Name:     "aaa",
								Symbol:   "a",
								Decimals: 18,
								Standard: metadata.StandardERC20,
							},
							To: metadata.Token{
								Address:  lo.ToPtr("0x45356c3721E479492D03c4d956AaEd17e8CA9BCe"),
								Value:    lo.ToPtr(lo.Must(decimal.NewFromString("362096591"))),
								Name:     "bbb",
								Symbol:   "b",
								Decimals: 18,
								Standard: metadata.StandardERC20,
							},
						},
					},
				},
				Status:    true,
				Timestamp: 1708793646,
			},
			wantError: require.NoError,
		},
	}

	for _, testcase := range testcases {
		testcase := testcase

		t.Run(testcase.name, func(t *testing.T) {
			t.Parallel()

			ctx := context.Background()

			instance, err := worker.NewWorker(testcase.arguments.config)
			require.NoError(t, err)

			matched, err := instance.Match(ctx, testcase.arguments.task)
			testcase.wantError(t, err)
			require.True(t, matched)

			feed, err := instance.Transform(ctx, testcase.arguments.task)
			testcase.wantError(t, err)

			//t.Log(string(lo.Must(json.MarshalIndent(feed, "", "\x20\x20"))))

			require.Equal(t, testcase.want, feed)
		})
	}
}
